---
title: "sex diffs july 2020 figs and model selection to run on pod"
author: "kelly wallace"
date: "7/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#as of july 7 2020 i can't install glmulti yet so I'm temporarily skipping the model selection
#PACKAGES
```{r, echo = FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(plyr)
library(stringr)
library(rmarkdown)
library(knitr)
library(utils)
library(EnvStats)
library(gridExtra)
library(factoextra)
library(GGally)
library(reshape2)
library(ggdendro)
library(pvclust)
library(RColorBrewer)
library(viridis)
library(glmmTMB)
library(gplots)
library(effsize)
library(ISLR)
library(dplyr)
library(readr)
library(tidyr)
library(ggfortify)
library(car)
library(broom)
library(jtools)
library(kableExtra)
library(AICcmodavg)
library(MESS)
library(glue)
#library(glmulti)
```

#IMPORT DATAFRAMES (will need to change these paths on different devices!)
#DATA CLEANUP/SETUP
#filtering by video must be at least 6 minutes long
#as of 5/20 NOT filtering by entering both zones in the video (lose a majority of the dataset when I do that)
```{r, echo = FALSE, message=FALSE, warning=FALSE}
nov <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/NOV_master.csv")
spa <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/SPA_master.csv")
weight<-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/weight_SL.csv")
spacurve <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/SPA_first_choice_four_trials.csv")
kp <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/KP_master.csv")


nov<-nov%>%filter(NOVtrial == "NOV1")
nov<-nov%>%filter(NOVvid_length >= 480)
#nov<-nov%>%filter(NOVdid_fish_enter_both_interaction_zones == 1) 

spa<-spa%>%filter(SPAtrial == "SPA4")
spa<-spa%>%filter(SPAvid_length >= 480)
spa<- spa %>% mutate(SPAcorrection_speed = SPAlatency_to_enter_correct_corner - SPAlatency_to_enter_a_corner)
#spa<-spa%>% filter(SPAprop_right_corner > 0 & SPAprop_left_corner > 0)


nov$fishID<- as.character(nov$fishID)
spa$fishID<- as.character(spa$fishID)

df<-weight  

file_list <- list.files("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/novel_object", pattern = "*.csv")

i<-1
k<-1
extendednov<-as.data.frame(vector(length = nrow(df)))
for(i in 1:length(file_list)){
  setwd("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/novel_object")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)
  filename <- file_list[i]
  filename_trial<-strsplit(filename, "_")[[1]][1]
  filename_round <- strsplit(filename, "_")[[1]][2]
  filename_date <- strsplit(filename, "_")[[1]][3]
  filename_tank <- strsplit(filename, "_")[[1]][4]
  filename_sex <- strsplit(filename, "_")[[1]][5]
  filename_color <- strsplit(filename, "_")[[1]][6]
  filename_time <- strsplit(filename, "_")[[1]][7]
  filename_tank <- strsplit(filename, "_")[[1]][8]
  filename_part <- strsplit(filename, "_")[[1]][9]
  fam_entries<-NA
  nov_entries<-NA
  mean_fam_int_bout_duration<-NA
  mean_nov_int_bout_duration<-NA
  print(filename)
  
  if (filename_trial == "NOV2"){next}
  if (filename_part == "part2"){next}
  
  if (filename_part == "part1"){
  initial_endtime<-fil$time[nrow(fil)]
  initial_rows<-nrow(fil)
  fil<-rbind(fil, read_csv(file_list[i+1], col_names = TRUE, col_types = NULL))
  j<-1
  for (j in 1:nrow(fil)){
  if (j>initial_rows){
      fil$time[j]<-fil$time[j] + initial_endtime}}
  if(fil$code[initial_rows-1]!=fil$code[initial_rows+1]){
    remove_rows<-c(initial_rows)
    fil<-fil[-remove_rows,]}
  if (fil$code[initial_rows-1]==fil$code[initial_rows+1]){
    remove_rows<-c(initial_rows, initial_rows + 1)
    fil<-fil[-remove_rows,]}}
    
  fil<-mutate(fil, time.difference = -(time -lead(time)))
  
    if(filename_round == "round1" | filename_round == "round2" |filename_round == "round5" | filename_round == "round6"){
    fam_entries<-fil[fil$code == "right_interaction",] %>% nrow()
    nov_entries<-fil[fil$code == "left_interaction",] %>% nrow()
    mean_fam_int_bout_duration <- mean(fil[fil$code == "right_interaction",]$time.difference, na.rm = TRUE)
    mean_nov_int_bout_duration<- mean(fil[fil$code == "left_interaction",]$time.difference, na.rm = TRUE)}
  
    if(filename_round == "round3" | filename_round == "round4" |filename_round == "round7" | filename_round == "round8"){
    fam_entries<-fil[fil$code == "left_interaction",] %>% nrow()
    nov_entries<-fil[fil$code == "right_interaction",] %>% nrow()
    mean_fam_int_bout_duration<- mean(fil[fil$code == "left_interaction",]$time.difference, na.rm = TRUE)
    mean_nov_int_bout_duration<- mean(fil[fil$code == "right_interaction",]$time.difference, na.rm = TRUE)}
  
  relative_entries<-fam_entries / (fam_entries + nov_entries)
  bout_duration_difference<-mean_fam_int_bout_duration - mean_nov_int_bout_duration
  print(k)
  extendednov$fishID[k]<-paste0(filename_round, filename_sex, filename_color, collapse="")
  extendednov$NOVfam_entries[k]<-fam_entries
  extendednov$NOVnov_entries[k]<-nov_entries
  extendednov$NOVprop_entries_familiar[k]<-relative_entries
  extendednov$NOVmean_fam_int_bout_duration[k]<-mean_fam_int_bout_duration
  extendednov$NOVmean_nov_int_bout_duration[k]<-mean_nov_int_bout_duration
  extendednov$NOVbout_duration_difference[k]<-bout_duration_difference
  k<-k+1}

  extendednov<-extendednov[!duplicated(extendednov$fishID), ]
  
  i<-1
  for(i in 1:nrow(extendednov)){
    if(is.na(extendednov$NOVmean_fam_int_bout_duration[i])== TRUE){extendednov$NOVmean_fam_int_bout_duration[i]<-0}
    if(is.na(extendednov$NOVmean_nov_int_bout_duration[i])== TRUE){extendednov$NOVmean_nov_int_bout_duration[i]<-0}
extendednov$NOVbout_duration_difference[i]<-extendednov$NOVmean_fam_int_bout_duration[i] - extendednov$NOVmean_nov_int_bout_duration[i]}
  
  nov<-left_join(nov, extendednov, by = "fishID")


df<-left_join(df, nov, by = "fishID")
df<-left_join(df, spa, by = "fishID")
df<-left_join(df,kp, by = "fishID")
df<-df[!duplicated(df$fishID), ]

#for this int was counted as dom
df$femsubdom_status<-df$KPstatus_day_15
df$femsubdom_status[which(df$sex == "female")]<-"female"
df$femsubdom_status[which(df$femsubdom_status == "int")]<-"dom"

df$NOVfirst_choice_familiar_or_novel_numeric<-as.numeric(df$NOVfirst_choice_familiar_or_novel) #novel = 2
df$SPAfirst_choice_correct_or_incorrect_corner_numeric<-as.numeric(df$SPAfirst_choice_correct_or_incorrect_corner) #correct = 1
df$SPAprop_sum_neutral<-df$SPAprop_neutral_zone + df$SPAprop_sum_wall

df.male<-df %>% filter(sex == "male")
df.female<-df %>% filter(sex == "female")

df$NOVis_familiar_preference_over_50<-NA
df$SPAis_correct_preference_over_50<-NA
i<-1
for(i in 1:nrow(df)){
  if (is.na(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time[i]) == FALSE & df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time[i] >0.5){
df$NOVis_familiar_preference_over_50[i]<-"nov_yes"}
    if (is.na(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time[i]) == FALSE & df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time[i] <0.5){
df$NOVis_familiar_preference_over_50[i]<-"nov_no"}}

i<-1
for(i in 1:nrow(df)){
  if (is.na(df$SPAprop_correct_including_corners_of_corner_and_platform_time[i]) == FALSE & df$SPAprop_correct_including_corners_of_corner_and_platform_time[i] >0.5){
df$SPAis_correct_preference_over_50[i]<-"spa_yes"}
    if (is.na(df$SPAprop_correct_including_corners_of_corner_and_platform_time[i]) == FALSE & df$SPAprop_correct_including_corners_of_corner_and_platform_time[i] <0.5){
df$SPAis_correct_preference_over_50[i]<-"spa_no"}}


continuouslist<-c("NOVlatency_to_enter_a_interaction", "NOVprop_sum_interaction", "NOVprop_sum_alley", "NOVprop_sum_corner", "NOVprop_familiar_interaction_and_corner", "NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time", "NOVlatency_to_enter_a_corner","NOVprop_familiar_interaction_and_corner_following_first_familiar_entry","NOVfam_entries", "NOVnov_entries", "NOVprop_entries_familiar", "NOVmean_fam_int_bout_duration","NOVmean_nov_int_bout_duration", "NOVbout_duration_difference",  "SPAprop_correct_including_corners_of_corner_and_platform_time","SPAprop_correct_including_corners_following_first_correct_corner_entry", "SPAprop_sum_corner_and_platform", "SPAprop_sum_corner", "SPAprop_sum_platform","SPAlatency_to_enter_a_platform", "SPAlatency_to_enter_a_corner",  "SPAprop_sum_wall", "SPAnumber_of_entries_total", "SPAlatency_to_enter_correct_corner")


#covariance matrix (across both assays) to filter out redundant variables (a pearson correlation coefficient above 0.8 is considered highly correlated, for two values that had that i only chose one based on biological significance)
i<-1
j<-1
k<-1
temp<-as.data.frame(vector(length = length(continuouslist) * length(continuouslist)))
 for(i in 1:length(continuouslist)){
  for(j in 1:length(continuouslist)){
measure1_name<-as.character(continuouslist[i])
measure2_name<-as.character(continuouslist[j])
temp$measure1[k]<-measure1_name
temp$measure2[k]<-measure2_name
temptemp<-as.data.frame(vector(length = nrow(df)))
temptemp$measure1<-df%>% select(measure1_name) %>% as.vector()
temptemp$measure2<-df%>% select(measure2_name) %>% as.vector()
temptemp<-temptemp %>% select(c(measure1,measure2))
temptemp<-as.matrix(temptemp)
temptemp<-as.data.frame(temptemp)
temptemp<-temptemp %>% filter(is.na(measure1) == FALSE & is.na(measure2) == FALSE)
pearson<-cor(temptemp$measure1, temptemp$measure2,  method = "pearson")
temp$abspearson[k]<-abs(pearson)
k<-k+1
  }}
temp<-temp%>% select(c(measure1,measure2,abspearson))
temp$abspearson<-as.numeric(temp$abspearson)
temp<-temp%>%filter(abspearson > 0.8 & abspearson< 1)
#temp

#the covariance matrix is how I selected which metrics went into new nov list (none of the spalist measures were >0.8 so kept all of them) - removed:
#NOVlatency_to_enter_a_corner
#NOVprop_familiar_interaction_and_corner
#NOVprop_familiar_interaction_and_corner_following_first_familiar_entry
#NOVprop_entries_familiar
#NOVbout_duration_difference

newnovlist<-c("NOVprop_sum_interaction", "NOVprop_sum_alley", "NOVprop_sum_corner", "NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time", "NOVlatency_to_enter_a_interaction", "NOVfam_entries", "NOVnov_entries","NOVmean_fam_int_bout_duration","NOVmean_nov_int_bout_duration")

spalist<-c("SPAprop_correct_including_corners_of_corner_and_platform_time","SPAprop_correct_including_corners_following_first_correct_corner_entry", "SPAprop_sum_corner_and_platform", "SPAprop_sum_corner", "SPAprop_sum_platform","SPAlatency_to_enter_a_platform", "SPAlatency_to_enter_a_corner",  "SPAprop_sum_wall", "SPAnumber_of_entries_total", "SPAlatency_to_enter_correct_corner")


#fullcontinuouslist is everything (non-redundant) in ALL ASSAYS you want to look at- these must be continuous measures

fullcontinuouslist<-c("SPAprop_correct_including_corners_of_corner_and_platform_time","SPAprop_correct_including_corners_following_first_correct_corner_entry", "SPAprop_sum_corner_and_platform", "SPAprop_sum_corner", "SPAprop_sum_platform","SPAlatency_to_enter_a_platform", "SPAlatency_to_enter_a_corner",  "SPAprop_sum_wall", "SPAnumber_of_entries_total", "SPAlatency_to_enter_correct_corner", "NOVprop_sum_interaction", "NOVprop_sum_alley", "NOVprop_sum_corner", "NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time", "NOVlatency_to_enter_a_interaction", "NOVfam_entries", "NOVnov_entries","NOVmean_fam_int_bout_duration","NOVmean_nov_int_bout_duration")

#factor list 2 is any factor (categorical variable, e.g. treatment) that has TWO options (so you can run t tests)
factorlist2<-c("sex", "NOVfirst_choice_familiar_or_novel", "SPAfirst_choice_correct_or_incorrect_corner", "NOVis_familiar_preference_over_50", "SPAis_correct_preference_over_50")

#factor list 2 male is factor list 2 but for only factors that apply within males (see how i've removed sex)
factorlist2male<-c("NOVfirst_choice_familiar_or_novel", "SPAfirst_choice_correct_or_incorrect_corner", "NOVis_familiar_preference_over_50", "SPAis_correct_preference_over_50")

#see above
factorlist2female<-c("NOVfirst_choice_familiar_or_novel", "SPAfirst_choice_correct_or_incorrect_corner", "NOVis_familiar_preference_over_50", "SPAis_correct_preference_over_50")

factorlist3<-c("NOVround")

factorlist<-append(factorlist2, factorlist3)

#average standard lengths
weight.male<-weight%>% filter(sex == "male")
weight.female<-weight%>% filter(sex == "female")
average_SL<- mean(weight$SL_start, na.rm = TRUE)
average_male_SL<- mean(weight.male$SL_start, na.rm = TRUE)
average_female_SL<- mean(weight.female$SL_start, na.rm = TRUE)
print(paste("average SL", average_SL))
print(paste("average male SL", average_male_SL))
print(paste("average female SL", average_female_SL))


#number of fish who didn't enter either object in nov
nov%>%filter(NOVprop_left_interaction == 0) %>% filter(NOVprop_right_interaction == 0) %>% nrow()


```

#preference over time data setup (both NOR and SPA)
```{r, echo = FALSE, message=FALSE, warning=FALSE}
file_list <- list.files("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/novel_object", pattern = "*.csv")

  sexlist<- vector(length = nrow(nov))
  statuslist<- vector(length = nrow(nov))
  seg1_prop_familiar_alley<- vector(length = nrow(nov))
  seg1_prop_novel_alley<-vector(length = nrow(nov))
  seg1_prop_familiar_corners<-vector(length = nrow(nov))
  seg1_prop_novel_corners<-vector(length = nrow(nov))
  seg1_prop_familiar_interaction<- vector(length = nrow(nov))
  seg1_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg1_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg2_prop_familiar_alley<- vector(length = nrow(nov))
  seg2_prop_novel_alley<-vector(length = nrow(nov))
  seg2_prop_familiar_corners<-vector(length = nrow(nov))
  seg2_prop_novel_corners<-vector(length = nrow(nov))
  seg2_prop_familiar_interaction<- vector(length = nrow(nov))
  seg2_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg2_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg3_prop_familiar_alley<- vector(length = nrow(nov))
  seg3_prop_novel_alley<-vector(length = nrow(nov))
  seg3_prop_familiar_corners<-vector(length = nrow(nov))
  seg3_prop_novel_corners<-vector(length = nrow(nov))
  seg3_prop_familiar_interaction<- vector(length = nrow(nov))
  seg3_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg3_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg4_prop_familiar_alley<- vector(length = nrow(nov))
  seg4_prop_novel_alley<-vector(length = nrow(nov))
  seg4_prop_familiar_corners<-vector(length = nrow(nov))
  seg4_prop_novel_corners<-vector(length = nrow(nov))
  seg4_prop_familiar_interaction<- vector(length = nrow(nov))
  seg4_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg4_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg5_prop_familiar_alley<- vector(length = nrow(nov))
  seg5_prop_novel_alley<-vector(length = nrow(nov))
  seg5_prop_familiar_corners<-vector(length = nrow(nov))
  seg5_prop_novel_corners<-vector(length = nrow(nov))
  seg5_prop_familiar_interaction<- vector(length = nrow(nov))
  seg5_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg5_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg6_prop_familiar_alley<- vector(length = nrow(nov))
  seg6_prop_novel_alley<-vector(length = nrow(nov))
  seg6_prop_familiar_corners<-vector(length = nrow(nov))
  seg6_prop_novel_corners<-vector(length = nrow(nov))
  seg6_prop_familiar_interaction<- vector(length = nrow(nov))
  seg6_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg6_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg7_prop_familiar_alley<- vector(length = nrow(nov))
  seg7_prop_novel_alley<-vector(length = nrow(nov))
  seg7_prop_familiar_corners<-vector(length = nrow(nov))
  seg7_prop_novel_corners<-vector(length = nrow(nov))
  seg7_prop_familiar_interaction<- vector(length = nrow(nov))
  seg7_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg7_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg8_prop_familiar_alley<- vector(length = nrow(nov))
  seg8_prop_novel_alley<-vector(length = nrow(nov))
  seg8_prop_familiar_corners<-vector(length = nrow(nov))
  seg8_prop_novel_corners<-vector(length = nrow(nov))
  seg8_prop_familiar_interaction<- vector(length = nrow(nov))
  seg8_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg8_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg9_prop_familiar_alley<- vector(length = nrow(nov))
  seg9_prop_novel_alley<-vector(length = nrow(nov))
  seg9_prop_familiar_corners<-vector(length = nrow(nov))
  seg9_prop_novel_corners<-vector(length = nrow(nov))
  seg9_prop_familiar_interaction<- vector(length = nrow(nov))
  seg9_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg9_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  seg10_prop_familiar_alley<- vector(length = nrow(nov))
  seg10_prop_novel_alley<-vector(length = nrow(nov))
  seg10_prop_familiar_corners<-vector(length = nrow(nov))
  seg10_prop_novel_corners<-vector(length = nrow(nov))
  seg10_prop_familiar_interaction<- vector(length = nrow(nov))
  seg10_prop_novel_interaction<-vector(length = nrow(nov)) 
  seg10_preference_familiar_corner_and_interaction<-vector(length = nrow(nov))
  
  nov_left_list<-c("round1", "round2", "round5", "round6")
  nov_right_list<-c("round3", "round4", "round7", "round8")
  

i<-1
k<-0
for(i in 1:length(file_list)){
  setwd("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/novel_object")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)
  filename <- file_list[i]
  filename_trial<-strsplit(filename, "_")[[1]][1]
  filename_round <- strsplit(filename, "_")[[1]][2]
  filename_date <- strsplit(filename, "_")[[1]][3]
  filename_tank <- strsplit(filename, "_")[[1]][4]
  filename_sex <- strsplit(filename, "_")[[1]][5]
  filename_color <- strsplit(filename, "_")[[1]][6]
  filename_time <- strsplit(filename, "_")[[1]][7]
  filename_tank <- strsplit(filename, "_")[[1]][8]
  filename_part <- strsplit(filename, "_")[[1]][9]
  
  if (filename_part == "part1"){
  initial_endtime<-fil$time[nrow(fil)]
  initial_rows<-nrow(fil)
  fil<-rbind(fil, read_csv(file_list[i+1], col_names = TRUE, col_types = NULL))
  j<-1
  for (j in 1:nrow(fil)){
  if (j>initial_rows){
      fil$time[j]<-fil$time[j] + initial_endtime}}
  
  if(fil$code[initial_rows-1]!=fil$code[initial_rows+1]){
    remove_rows<-c(initial_rows)
    fil<-fil[-remove_rows,]}
  if (fil$code[initial_rows-1]==fil$code[initial_rows+1]){
    remove_rows<-c(initial_rows, initial_rows + 1)
    fil<-fil[-remove_rows,]}}
  
  vid_length<-fil$time[nrow(fil)] - fil$time[1]

if (filename_part != "part2" & vid_length >= 600 & filename_trial != "NOV2"){ #only 3 vids are shorter than 600
   k<-k+1

  segment_length<-60
  
  fishID<-paste0(filename_round, filename_sex, filename_color, collapse="")
  round<-filename_round
  stamp1<-fil$time[1]
  stamp2<-fil$time[1] + segment_length
  stamp3<-fil$time[1] + (segment_length*2)
  stamp4<-fil$time[1] + (segment_length*3)
  stamp5<-fil$time[1] + (segment_length*4)
  stamp6<-fil$time[1] + (segment_length*5)
  stamp7<-fil$time[1] + (segment_length*6)
  stamp8<-fil$time[1] + (segment_length*7)
  stamp9<-fil$time[1] + (segment_length*8)
  stamp10<-fil$time[1] + (segment_length*9)
  stamp11<-fil$time[1] + (segment_length*10)
  
  segment1<-fil[2:max(which(fil$time<stamp2)),]
  segment2<-fil[(which(fil$time>stamp2)-1):max(which(fil$time<stamp3)),]
  segment3<-fil[(which(fil$time>stamp3)-1):max(which(fil$time<stamp4)),]
  segment4<-fil[(which(fil$time>stamp4)-1):max(which(fil$time<stamp5)),]
  segment5<-fil[(which(fil$time>stamp5)-1):max(which(fil$time<stamp6)),]
  segment6<-fil[(which(fil$time>stamp6)-1):max(which(fil$time<stamp7)),]
  segment7<-fil[(which(fil$time>stamp7)-1):max(which(fil$time<stamp8)),]
  segment8<-fil[(which(fil$time>stamp8)-1):max(which(fil$time<stamp9)),]
  segment9<-fil[(which(fil$time>stamp9)-1):max(which(fil$time<stamp10)),]
  segment10<-fil[(which(fil$time>stamp10)-1):max(which(fil$time<stamp11)),]
  
  segment1$time[1]<-stamp1
  segment2$time[1]<-stamp2
  segment3$time[1]<-stamp3
  segment4$time[1]<-stamp4
  segment5$time[1]<-stamp5
  segment6$time[1]<-stamp6
  segment7$time[1]<-stamp7
  segment8$time[1]<-stamp8
  segment9$time[1]<-stamp9
  segment10$time[1]<-stamp10
  
  segment1<-mutate(segment1, time.difference = -(time -lead(time)))
  segment1$time.difference[nrow(segment1)]<- (segment_length + segment1$time[1]) - segment1$time[nrow(segment1)]
  segment2<-mutate(segment2, time.difference = -(time -lead(time)))
  segment2$time.difference[nrow(segment2)]<- (segment_length + segment2$time[1]) - segment2$time[nrow(segment2)]
  segment3<-mutate(segment3, time.difference = -(time -lead(time)))
  segment3$time.difference[nrow(segment3)]<- (segment_length + segment3$time[1]) - segment3$time[nrow(segment3)]
  segment4<-mutate(segment4, time.difference = -(time -lead(time)))
  segment4$time.difference[nrow(segment4)]<- (segment_length + segment4$time[1]) - segment4$time[nrow(segment4)]
  segment5<-mutate(segment5, time.difference = -(time -lead(time)))
  segment5$time.difference[nrow(segment5)]<- (segment_length + segment5$time[1]) - segment5$time[nrow(segment5)]
  segment6<-mutate(segment6, time.difference = -(time -lead(time)))
  segment6$time.difference[nrow(segment6)]<- (segment_length + segment6$time[1]) - segment6$time[nrow(segment6)]
  segment7<-mutate(segment7, time.difference = -(time -lead(time)))
  segment7$time.difference[nrow(segment7)]<- (segment_length + segment7$time[1]) - segment7$time[nrow(segment7)]
  segment8<-mutate(segment8, time.difference = -(time -lead(time)))
  segment8$time.difference[nrow(segment8)]<- (segment_length + segment8$time[1]) - segment8$time[nrow(segment8)]
  segment9<-mutate(segment9, time.difference = -(time -lead(time)))
  segment9$time.difference[nrow(segment9)]<- (segment_length + segment9$time[1]) - segment9$time[nrow(segment9)]
  segment10<-mutate(segment10, time.difference = -(time -lead(time)))
  segment10$time.difference[nrow(segment10)]<- (segment_length + segment10$time[1]) - segment10$time[nrow(segment10)]
  
   sexlist[k]<-filename_sex
   statuslist[k]<-NA
  
  if (filename_round %in% nov_left_list){
  seg1_prop_familiar_alley[k]<- segment1 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_novel_alley[k]<-segment1 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_familiar_corners[k]<-segment1 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_novel_corners[k]<-segment1 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_familiar_interaction[k]<- segment1 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_novel_interaction[k]<- segment1 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg1_preference_familiar_corner_and_interaction[k]<-(seg1_prop_familiar_corners[k] + seg1_prop_familiar_interaction[k]) / (seg1_prop_familiar_corners[k] + seg1_prop_familiar_interaction[k] + seg1_prop_novel_corners[k] + seg1_prop_novel_interaction[k])
    seg2_prop_familiar_alley[k]<- segment2 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_novel_alley[k]<-segment2 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_familiar_corners[k]<-segment2 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_novel_corners[k]<-segment2 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_familiar_interaction[k]<- segment2 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_novel_interaction[k]<- segment2 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg2_preference_familiar_corner_and_interaction[k]<-(seg2_prop_familiar_corners[k] + seg2_prop_familiar_interaction[k]) / (seg2_prop_familiar_corners[k] + seg2_prop_familiar_interaction[k] + seg2_prop_novel_corners[k] + seg2_prop_novel_interaction[k]) 
    seg3_prop_familiar_alley[k]<- segment3 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_novel_alley[k]<-segment3 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_familiar_corners[k]<-segment3 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_novel_corners[k]<-segment3 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_familiar_interaction[k]<- segment3 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_novel_interaction[k]<- segment3 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg3_preference_familiar_corner_and_interaction[k]<-(seg3_prop_familiar_corners[k] + seg3_prop_familiar_interaction[k]) / (seg3_prop_familiar_corners[k] + seg3_prop_familiar_interaction[k] + seg3_prop_novel_corners[k] + seg3_prop_novel_interaction[k])
    seg4_prop_familiar_alley[k]<- segment4 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_novel_alley[k]<-segment4 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_familiar_corners[k]<-segment4 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_novel_corners[k]<-segment4 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_familiar_interaction[k]<- segment4 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_novel_interaction[k]<- segment4 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg4_preference_familiar_corner_and_interaction[k]<-(seg4_prop_familiar_corners[k] + seg4_prop_familiar_interaction[k]) / (seg4_prop_familiar_corners[k] + seg4_prop_familiar_interaction[k] + seg4_prop_novel_corners[k] + seg4_prop_novel_interaction[k])
    seg5_prop_familiar_alley[k]<- segment5 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_novel_alley[k]<-segment5 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_familiar_corners[k]<-segment5 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_novel_corners[k]<-segment5 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_familiar_interaction[k]<- segment5 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_novel_interaction[k]<- segment5 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg5_preference_familiar_corner_and_interaction[k]<-(seg5_prop_familiar_corners[k] + seg5_prop_familiar_interaction[k]) / (seg5_prop_familiar_corners[k] + seg5_prop_familiar_interaction[k] + seg5_prop_novel_corners[k] + seg5_prop_novel_interaction[k])
    seg6_prop_familiar_alley[k]<- segment6 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_novel_alley[k]<-segment6 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_familiar_corners[k]<-segment6 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_novel_corners[k]<-segment6 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_familiar_interaction[k]<- segment6 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_novel_interaction[k]<- segment6 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg6_preference_familiar_corner_and_interaction[k]<-(seg6_prop_familiar_corners[k] + seg6_prop_familiar_interaction[k]) / (seg6_prop_familiar_corners[k] + seg6_prop_familiar_interaction[k] + seg6_prop_novel_corners[k] + seg6_prop_novel_interaction[k])
    seg7_prop_familiar_alley[k]<- segment7 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_novel_alley[k]<-segment7 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_familiar_corners[k]<-segment7 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_novel_corners[k]<-segment7 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_familiar_interaction[k]<- segment7 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_novel_interaction[k]<- segment7 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg7_preference_familiar_corner_and_interaction[k]<-(seg7_prop_familiar_corners[k] + seg7_prop_familiar_interaction[k]) / (seg7_prop_familiar_corners[k] + seg7_prop_familiar_interaction[k] + seg7_prop_novel_corners[k] + seg7_prop_novel_interaction[k])
    seg8_prop_familiar_alley[k]<- segment8 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_novel_alley[k]<-segment8 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_familiar_corners[k]<-segment8 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_novel_corners[k]<-segment8 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_familiar_interaction[k]<- segment8 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_novel_interaction[k]<- segment8 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg8_preference_familiar_corner_and_interaction[k]<-(seg8_prop_familiar_corners[k] + seg8_prop_familiar_interaction[k]) / (seg8_prop_familiar_corners[k] + seg8_prop_familiar_interaction[k] + seg8_prop_novel_corners[k] + seg8_prop_novel_interaction[k])
    seg9_prop_familiar_alley[k]<- segment9 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_novel_alley[k]<-segment9 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_familiar_corners[k]<-segment9 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_novel_corners[k]<-segment9 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_familiar_interaction[k]<- segment9 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_novel_interaction[k]<- segment9 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg9_preference_familiar_corner_and_interaction[k]<-(seg9_prop_familiar_corners[k] + seg9_prop_familiar_interaction[k]) / (seg9_prop_familiar_corners[k] + seg9_prop_familiar_interaction[k] + seg9_prop_novel_corners[k] + seg9_prop_novel_interaction[k])
    seg10_prop_familiar_alley[k]<- segment10 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_novel_alley[k]<-segment10 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_familiar_corners[k]<-segment10 %>% filter(code == "upper_right_corner"|code == "lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_novel_corners[k]<-segment10 %>% filter(code == "upper_left_corner"|code =="lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_familiar_interaction[k]<- segment10 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_novel_interaction[k]<- segment10 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg10_preference_familiar_corner_and_interaction[k]<-(seg10_prop_familiar_corners[k] + seg10_prop_familiar_interaction[k]) / (seg10_prop_familiar_corners[k] + seg10_prop_familiar_interaction[k] + seg10_prop_novel_corners[k] + seg10_prop_novel_interaction[k])}
                                                                                                                               
  
  if (filename_round %in% nov_right_list){  
    seg1_prop_familiar_alley[k]<- segment1 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_novel_alley[k]<-segment1 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_familiar_corners[k]<-segment1 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_novel_corners[k]<-segment1 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_familiar_interaction[k]<- segment1 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_novel_interaction[k]<- segment1 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg1_preference_familiar_corner_and_interaction[k]<-(seg1_prop_familiar_corners[k] + seg1_prop_familiar_interaction[k]) / (seg1_prop_familiar_corners[k] + seg1_prop_familiar_interaction[k] + seg1_prop_novel_corners[k] + seg1_prop_novel_interaction[k])
    seg2_prop_familiar_alley[k]<- segment2 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_novel_alley[k]<-segment2 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_familiar_corners[k]<-segment2 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_novel_corners[k]<-segment2 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_familiar_interaction[k]<- segment2 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_novel_interaction[k]<- segment2 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg2_preference_familiar_corner_and_interaction[k]<-(seg2_prop_familiar_corners[k] + seg2_prop_familiar_interaction[k]) / (seg2_prop_familiar_corners[k] + seg2_prop_familiar_interaction[k] + seg2_prop_novel_corners[k] + seg2_prop_novel_interaction[k]) 
    seg3_prop_familiar_alley[k]<- segment3 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_novel_alley[k]<-segment3 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_familiar_corners[k]<-segment3 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_novel_corners[k]<-segment3 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_familiar_interaction[k]<- segment3 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_novel_interaction[k]<- segment3 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg3_preference_familiar_corner_and_interaction[k]<-(seg3_prop_familiar_corners[k] + seg3_prop_familiar_interaction[k]) / (seg3_prop_familiar_corners[k] + seg3_prop_familiar_interaction[k] + seg3_prop_novel_corners[k] + seg3_prop_novel_interaction[k])
    seg4_prop_familiar_alley[k]<- segment4 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_novel_alley[k]<-segment4 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_familiar_corners[k]<-segment4 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_novel_corners[k]<-segment4 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_familiar_interaction[k]<- segment4 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_novel_interaction[k]<- segment4 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg4_preference_familiar_corner_and_interaction[k]<-(seg4_prop_familiar_corners[k] + seg4_prop_familiar_interaction[k]) / (seg4_prop_familiar_corners[k] + seg4_prop_familiar_interaction[k] + seg4_prop_novel_corners[k] + seg4_prop_novel_interaction[k])
    seg5_prop_familiar_alley[k]<- segment5 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_novel_alley[k]<-segment5 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_familiar_corners[k]<-segment5 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_novel_corners[k]<-segment5 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_familiar_interaction[k]<- segment5 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_novel_interaction[k]<- segment5 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg5_preference_familiar_corner_and_interaction[k]<-(seg5_prop_familiar_corners[k] + seg5_prop_familiar_interaction[k]) / (seg5_prop_familiar_corners[k] + seg5_prop_familiar_interaction[k] + seg5_prop_novel_corners[k] + seg5_prop_novel_interaction[k])
    seg6_prop_familiar_alley[k]<- segment6 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_novel_alley[k]<-segment6 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_familiar_corners[k]<-segment6 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_novel_corners[k]<-segment6 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_familiar_interaction[k]<- segment6 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_novel_interaction[k]<- segment6 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg6_preference_familiar_corner_and_interaction[k]<-(seg6_prop_familiar_corners[k] + seg6_prop_familiar_interaction[k]) / (seg6_prop_familiar_corners[k] + seg6_prop_familiar_interaction[k] + seg6_prop_novel_corners[k] + seg6_prop_novel_interaction[k])
    seg7_prop_familiar_alley[k]<- segment7 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_novel_alley[k]<-segment7 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_familiar_corners[k]<-segment7 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_novel_corners[k]<-segment7 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_familiar_interaction[k]<- segment7 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_novel_interaction[k]<- segment7 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg7_preference_familiar_corner_and_interaction[k]<-(seg7_prop_familiar_corners[k] + seg7_prop_familiar_interaction[k]) / (seg7_prop_familiar_corners[k] + seg7_prop_familiar_interaction[k] + seg7_prop_novel_corners[k] + seg7_prop_novel_interaction[k])
    seg8_prop_familiar_alley[k]<- segment8 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_novel_alley[k]<-segment8 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_familiar_corners[k]<-segment8 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_novel_corners[k]<-segment8 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_familiar_interaction[k]<- segment8 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_novel_interaction[k]<- segment8 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg8_preference_familiar_corner_and_interaction[k]<-(seg8_prop_familiar_corners[k] + seg8_prop_familiar_interaction[k]) / (seg8_prop_familiar_corners[k] + seg8_prop_familiar_interaction[k] + seg8_prop_novel_corners[k] + seg8_prop_novel_interaction[k])
    seg9_prop_familiar_alley[k]<- segment9 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_novel_alley[k]<-segment9 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_familiar_corners[k]<-segment9 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_novel_corners[k]<-segment9 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_familiar_interaction[k]<- segment9 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_novel_interaction[k]<- segment9 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg9_preference_familiar_corner_and_interaction[k]<-(seg9_prop_familiar_corners[k] + seg9_prop_familiar_interaction[k]) / (seg9_prop_familiar_corners[k] + seg9_prop_familiar_interaction[k] + seg9_prop_novel_corners[k] + seg9_prop_novel_interaction[k])
    seg10_prop_familiar_alley[k]<- segment10 %>% filter(code == "left_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_novel_alley[k]<-segment10 %>% filter(code == "right_alley") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_familiar_corners[k]<-segment10 %>% filter(code == "upper_left_corner"|code == "lower_left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_novel_corners[k]<-segment10 %>% filter(code == "upper_right_corner"|code =="lower_right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_familiar_interaction[k]<- segment10 %>% filter(code == "left_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_novel_interaction[k]<- segment10 %>% filter(code == "right_interaction") %>% pull(time.difference) %>% sum()/segment_length
  seg10_preference_familiar_corner_and_interaction[k]<-(seg10_prop_familiar_corners[k] + seg10_prop_familiar_interaction[k]) / (seg10_prop_familiar_corners[k] + seg10_prop_familiar_interaction[k] + seg10_prop_novel_corners[k] + seg10_prop_novel_interaction[k])}
}}

#FEMALES
  seg1_fprop_familiar_alley<- seg1_prop_familiar_alley[which(sexlist == "female")]
  seg1_fprop_novel_alley<-seg1_prop_novel_alley[which(sexlist == "female")]
  seg1_fprop_familiar_corners<-seg1_prop_familiar_corners[which(sexlist == "female")]
  seg1_fprop_novel_corners<-seg1_prop_novel_corners[which(sexlist == "female")]
  seg1_fprop_familiar_interaction<- seg1_prop_familiar_interaction[which(sexlist == "female")]
  seg1_fprop_novel_interaction<- seg1_prop_novel_interaction[which(sexlist == "female")]
  seg1_fpreference_familiar_corner_and_interaction<-seg1_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg2_fprop_familiar_alley<- seg2_prop_familiar_alley[which(sexlist == "female")]
  seg2_fprop_novel_alley<-seg2_prop_novel_alley[which(sexlist == "female")]
  seg2_fprop_familiar_corners<-seg2_prop_familiar_corners[which(sexlist == "female")]
  seg2_fprop_novel_corners<-seg2_prop_novel_corners[which(sexlist == "female")]
  seg2_fprop_familiar_interaction<- seg2_prop_familiar_interaction[which(sexlist == "female")]
  seg2_fprop_novel_interaction<- seg2_prop_novel_interaction[which(sexlist == "female")]
  seg2_fpreference_familiar_corner_and_interaction<-seg2_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg3_fprop_familiar_alley<- seg3_prop_familiar_alley[which(sexlist == "female")]
  seg3_fprop_novel_alley<-seg3_prop_novel_alley[which(sexlist == "female")]
  seg3_fprop_familiar_corners<-seg3_prop_familiar_corners[which(sexlist == "female")]
  seg3_fprop_novel_corners<-seg3_prop_novel_corners[which(sexlist == "female")]
  seg3_fprop_familiar_interaction<- seg3_prop_familiar_interaction[which(sexlist == "female")]
  seg3_fprop_novel_interaction<- seg3_prop_novel_interaction[which(sexlist == "female")]
  seg3_fpreference_familiar_corner_and_interaction<-seg3_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg4_fprop_familiar_alley<- seg4_prop_familiar_alley[which(sexlist == "female")]
  seg4_fprop_novel_alley<-seg4_prop_novel_alley[which(sexlist == "female")]
  seg4_fprop_familiar_corners<-seg4_prop_familiar_corners[which(sexlist == "female")]
  seg4_fprop_novel_corners<-seg4_prop_novel_corners[which(sexlist == "female")]
  seg4_fprop_familiar_interaction<- seg4_prop_familiar_interaction[which(sexlist == "female")]
  seg4_fprop_novel_interaction<- seg4_prop_novel_interaction[which(sexlist == "female")]
  seg4_fpreference_familiar_corner_and_interaction<-seg4_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg5_fprop_familiar_alley<- seg5_prop_familiar_alley[which(sexlist == "female")]
  seg5_fprop_novel_alley<-seg5_prop_novel_alley[which(sexlist == "female")]
  seg5_fprop_familiar_corners<-seg5_prop_familiar_corners[which(sexlist == "female")]
  seg5_fprop_novel_corners<-seg5_prop_novel_corners[which(sexlist == "female")]
  seg5_fprop_familiar_interaction<- seg5_prop_familiar_interaction[which(sexlist == "female")]
  seg5_fprop_novel_interaction<- seg5_prop_novel_interaction[which(sexlist == "female")]
  seg5_fpreference_familiar_corner_and_interaction<-seg5_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg6_fprop_familiar_alley<- seg6_prop_familiar_alley[which(sexlist == "female")]
  seg6_fprop_novel_alley<-seg6_prop_novel_alley[which(sexlist == "female")]
  seg6_fprop_familiar_corners<-seg6_prop_familiar_corners[which(sexlist == "female")]
  seg6_fprop_novel_corners<-seg6_prop_novel_corners[which(sexlist == "female")]
  seg6_fprop_familiar_interaction<- seg6_prop_familiar_interaction[which(sexlist == "female")]
  seg6_fprop_novel_interaction<- seg6_prop_novel_interaction[which(sexlist == "female")]
  seg6_fpreference_familiar_corner_and_interaction<-seg6_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg7_fprop_familiar_alley<- seg7_prop_familiar_alley[which(sexlist == "female")]
  seg7_fprop_novel_alley<-seg7_prop_novel_alley[which(sexlist == "female")]
  seg7_fprop_familiar_corners<-seg7_prop_familiar_corners[which(sexlist == "female")]
  seg7_fprop_novel_corners<-seg7_prop_novel_corners[which(sexlist == "female")]
  seg7_fprop_familiar_interaction<- seg7_prop_familiar_interaction[which(sexlist == "female")]
  seg7_fprop_novel_interaction<- seg7_prop_novel_interaction[which(sexlist == "female")]
  seg7_fpreference_familiar_corner_and_interaction<-seg7_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg8_fprop_familiar_alley<- seg8_prop_familiar_alley[which(sexlist == "female")]
  seg8_fprop_novel_alley<-seg8_prop_novel_alley[which(sexlist == "female")]
  seg8_fprop_familiar_corners<-seg8_prop_familiar_corners[which(sexlist == "female")]
  seg8_fprop_novel_corners<-seg8_prop_novel_corners[which(sexlist == "female")]
  seg8_fprop_familiar_interaction<- seg8_prop_familiar_interaction[which(sexlist == "female")]
  seg8_fprop_novel_interaction<- seg8_prop_novel_interaction[which(sexlist == "female")]
  seg8_fpreference_familiar_corner_and_interaction<-seg8_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg9_fprop_familiar_alley<- seg9_prop_familiar_alley[which(sexlist == "female")]
  seg9_fprop_novel_alley<-seg9_prop_novel_alley[which(sexlist == "female")]
  seg9_fprop_familiar_corners<-seg9_prop_familiar_corners[which(sexlist == "female")]
  seg9_fprop_novel_corners<-seg9_prop_novel_corners[which(sexlist == "female")]
  seg9_fprop_familiar_interaction<- seg9_prop_familiar_interaction[which(sexlist == "female")]
  seg9_fprop_novel_interaction<- seg9_prop_novel_interaction[which(sexlist == "female")]
  seg9_fpreference_familiar_corner_and_interaction<-seg9_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  seg10_fprop_familiar_alley<- seg10_prop_familiar_alley[which(sexlist == "female")]
  seg10_fprop_novel_alley<-seg10_prop_novel_alley[which(sexlist == "female")]
  seg10_fprop_familiar_corners<-seg10_prop_familiar_corners[which(sexlist == "female")]
  seg10_fprop_novel_corners<-seg10_prop_novel_corners[which(sexlist == "female")]
  seg10_fprop_familiar_interaction<- seg10_prop_familiar_interaction[which(sexlist == "female")]
  seg10_fprop_novel_interaction<- seg10_prop_novel_interaction[which(sexlist == "female")]
  seg10_fpreference_familiar_corner_and_interaction<-seg10_preference_familiar_corner_and_interaction[which(sexlist == "female")]
  
  

fullframef<-as.data.frame(vector(length = 10))
i<-1
for (i in 1:10){
fullframef$segment[i]<-i
fullframef$prop_familiar_alley[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_familiar_alley", sep = ""))), na.rm = TRUE)*100
fullframef$prop_novel_alley[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_novel_alley", sep = ""))), na.rm = TRUE)*100
fullframef$prop_familiar_corners[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_familiar_corners", sep = ""))), na.rm = TRUE)*100
fullframef$prop_novel_corners[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_novel_corners", sep = ""))), na.rm = TRUE)*100
fullframef$prop_familiar_interaction[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_familiar_interaction", sep = ""))), na.rm = TRUE)*100
fullframef$prop_novel_interaction[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_novel_interaction", sep = ""))), na.rm = TRUE)*100
fullframef$preference_familiar_corner_and_interaction[i]<-mean(eval(parse(text = paste("seg", {i}, "_fpreference_familiar_corner_and_interaction", sep = ""))), na.rm = TRUE)*100
}


fullframevaluef<-(vector(length = 60))
k<-1
i<-1
for (i in 1:10){
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_familiar_alley", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_novel_alley", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_familiar_corners", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_novel_corners", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_familiar_interaction", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_novel_interaction", sep = ""))), na.rm = TRUE)*100
k<-k+1}

#MALES
  seg1_mprop_familiar_alley<- seg1_prop_familiar_alley[which(sexlist == "male")]
  seg1_mprop_novel_alley<-seg1_prop_novel_alley[which(sexlist == "male")]
  seg1_mprop_familiar_corners<-seg1_prop_familiar_corners[which(sexlist == "male")]
  seg1_mprop_novel_corners<-seg1_prop_novel_corners[which(sexlist == "male")]
  seg1_mprop_familiar_interaction<- seg1_prop_familiar_interaction[which(sexlist == "male")]
  seg1_mprop_novel_interaction<- seg1_prop_novel_interaction[which(sexlist == "male")]
  seg1_mpreference_familiar_corner_and_interaction<-seg1_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg2_mprop_familiar_alley<- seg2_prop_familiar_alley[which(sexlist == "male")]
  seg2_mprop_novel_alley<-seg2_prop_novel_alley[which(sexlist == "male")]
  seg2_mprop_familiar_corners<-seg2_prop_familiar_corners[which(sexlist == "male")]
  seg2_mprop_novel_corners<-seg2_prop_novel_corners[which(sexlist == "male")]
  seg2_mprop_familiar_interaction<- seg2_prop_familiar_interaction[which(sexlist == "male")]
  seg2_mprop_novel_interaction<- seg2_prop_novel_interaction[which(sexlist == "male")]
  seg2_mpreference_familiar_corner_and_interaction<-seg2_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg3_mprop_familiar_alley<- seg3_prop_familiar_alley[which(sexlist == "male")]
  seg3_mprop_novel_alley<-seg3_prop_novel_alley[which(sexlist == "male")]
  seg3_mprop_familiar_corners<-seg3_prop_familiar_corners[which(sexlist == "male")]
  seg3_mprop_novel_corners<-seg3_prop_novel_corners[which(sexlist == "male")]
  seg3_mprop_familiar_interaction<- seg3_prop_familiar_interaction[which(sexlist == "male")]
  seg3_mprop_novel_interaction<- seg3_prop_novel_interaction[which(sexlist == "male")]
  seg3_mpreference_familiar_corner_and_interaction<-seg3_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg4_mprop_familiar_alley<- seg4_prop_familiar_alley[which(sexlist == "male")]
  seg4_mprop_novel_alley<-seg4_prop_novel_alley[which(sexlist == "male")]
  seg4_mprop_familiar_corners<-seg4_prop_familiar_corners[which(sexlist == "male")]
  seg4_mprop_novel_corners<-seg4_prop_novel_corners[which(sexlist == "male")]
  seg4_mprop_familiar_interaction<- seg4_prop_familiar_interaction[which(sexlist == "male")]
  seg4_mprop_novel_interaction<- seg4_prop_novel_interaction[which(sexlist == "male")]
  seg4_mpreference_familiar_corner_and_interaction<-seg4_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg5_mprop_familiar_alley<- seg5_prop_familiar_alley[which(sexlist == "male")]
  seg5_mprop_novel_alley<-seg5_prop_novel_alley[which(sexlist == "male")]
  seg5_mprop_familiar_corners<-seg5_prop_familiar_corners[which(sexlist == "male")]
  seg5_mprop_novel_corners<-seg5_prop_novel_corners[which(sexlist == "male")]
  seg5_mprop_familiar_interaction<- seg5_prop_familiar_interaction[which(sexlist == "male")]
  seg5_mprop_novel_interaction<- seg5_prop_novel_interaction[which(sexlist == "male")]
  seg5_mpreference_familiar_corner_and_interaction<-seg5_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg6_mprop_familiar_alley<- seg6_prop_familiar_alley[which(sexlist == "male")]
  seg6_mprop_novel_alley<-seg6_prop_novel_alley[which(sexlist == "male")]
  seg6_mprop_familiar_corners<-seg6_prop_familiar_corners[which(sexlist == "male")]
  seg6_mprop_novel_corners<-seg6_prop_novel_corners[which(sexlist == "male")]
  seg6_mprop_familiar_interaction<- seg6_prop_familiar_interaction[which(sexlist == "male")]
  seg6_mprop_novel_interaction<- seg6_prop_novel_interaction[which(sexlist == "male")]
  seg6_mpreference_familiar_corner_and_interaction<-seg6_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg7_mprop_familiar_alley<- seg7_prop_familiar_alley[which(sexlist == "male")]
  seg7_mprop_novel_alley<-seg7_prop_novel_alley[which(sexlist == "male")]
  seg7_mprop_familiar_corners<-seg7_prop_familiar_corners[which(sexlist == "male")]
  seg7_mprop_novel_corners<-seg7_prop_novel_corners[which(sexlist == "male")]
  seg7_mprop_familiar_interaction<- seg7_prop_familiar_interaction[which(sexlist == "male")]
  seg7_mprop_novel_interaction<- seg7_prop_novel_interaction[which(sexlist == "male")]
  seg7_mpreference_familiar_corner_and_interaction<-seg7_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg8_mprop_familiar_alley<- seg8_prop_familiar_alley[which(sexlist == "male")]
  seg8_mprop_novel_alley<-seg8_prop_novel_alley[which(sexlist == "male")]
  seg8_mprop_familiar_corners<-seg8_prop_familiar_corners[which(sexlist == "male")]
  seg8_mprop_novel_corners<-seg8_prop_novel_corners[which(sexlist == "male")]
  seg8_mprop_familiar_interaction<- seg8_prop_familiar_interaction[which(sexlist == "male")]
  seg8_mprop_novel_interaction<- seg8_prop_novel_interaction[which(sexlist == "male")]
  seg8_mpreference_familiar_corner_and_interaction<-seg8_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg9_mprop_familiar_alley<- seg9_prop_familiar_alley[which(sexlist == "male")]
  seg9_mprop_novel_alley<-seg9_prop_novel_alley[which(sexlist == "male")]
  seg9_mprop_familiar_corners<-seg9_prop_familiar_corners[which(sexlist == "male")]
  seg9_mprop_novel_corners<-seg9_prop_novel_corners[which(sexlist == "male")]
  seg9_mprop_familiar_interaction<- seg9_prop_familiar_interaction[which(sexlist == "male")]
  seg9_mprop_novel_interaction<- seg9_prop_novel_interaction[which(sexlist == "male")]
  seg9_mpreference_familiar_corner_and_interaction<-seg9_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  seg10_mprop_familiar_alley<- seg10_prop_familiar_alley[which(sexlist == "male")]
  seg10_mprop_novel_alley<-seg10_prop_novel_alley[which(sexlist == "male")]
  seg10_mprop_familiar_corners<-seg10_prop_familiar_corners[which(sexlist == "male")]
  seg10_mprop_novel_corners<-seg10_prop_novel_corners[which(sexlist == "male")]
  seg10_mprop_familiar_interaction<- seg10_prop_familiar_interaction[which(sexlist == "male")]
  seg10_mprop_novel_interaction<- seg10_prop_novel_interaction[which(sexlist == "male")]
  seg10_mpreference_familiar_corner_and_interaction<-seg10_preference_familiar_corner_and_interaction[which(sexlist == "male")]
  
  

fullframem<-as.data.frame(vector(length = 10))
i<-1
for (i in 1:10){
fullframem$segment[i]<-i
fullframem$prop_familiar_alley[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_familiar_alley", sep = ""))), na.rm = TRUE)*100
fullframem$prop_novel_alley[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_novel_alley", sep = ""))), na.rm = TRUE)*100
fullframem$prop_familiar_corners[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_familiar_corners", sep = ""))), na.rm = TRUE)*100
fullframem$prop_novel_corners[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_novel_corners", sep = ""))), na.rm = TRUE)*100
fullframem$prop_familiar_interaction[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_familiar_interaction", sep = ""))), na.rm = TRUE)*100
fullframem$prop_novel_interaction[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_novel_interaction", sep = ""))), na.rm = TRUE)*100
fullframem$preference_familiar_corner_and_interaction[i]<-mean(eval(parse(text = paste("seg", {i}, "_mpreference_familiar_corner_and_interaction", sep = ""))), na.rm = TRUE)*100
}


fullframevaluem<-(vector(length = 60))
k<-1
i<-1
for (i in 1:10){
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_familiar_alley", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_novel_alley", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_familiar_corners", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_novel_corners", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_familiar_interaction", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_novel_interaction", sep = ""))), na.rm = TRUE)*100
k<-k+1}




#ONTO SPA
file_list <- list.files("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/spatial_maze", pattern = "*.csv")

  sexlist<- vector(length = nrow(spa))
  statuslist<- vector(length = nrow(spa))
  seg1_prop_sum_wall<- vector(length = nrow(spa))
  seg1_prop_neutral_zone<-vector(length = nrow(spa))
  seg1_prop_correct_corner<-vector(length = nrow(spa))
  seg1_prop_incorrect_corner<-vector(length = nrow(spa))
  seg1_prop_correct_platform<- vector(length = nrow(spa))
  seg1_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg1_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg2_prop_sum_wall<- vector(length = nrow(spa))
  seg2_prop_neutral_zone<-vector(length = nrow(spa))
  seg2_prop_correct_corner<-vector(length = nrow(spa))
  seg2_prop_incorrect_corner<-vector(length = nrow(spa))
  seg2_prop_correct_platform<- vector(length = nrow(spa))
  seg2_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg2_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg3_prop_sum_wall<- vector(length = nrow(spa))
  seg3_prop_neutral_zone<-vector(length = nrow(spa))
  seg3_prop_correct_corner<-vector(length = nrow(spa))
  seg3_prop_incorrect_corner<-vector(length = nrow(spa))
  seg3_prop_correct_platform<- vector(length = nrow(spa))
  seg3_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg3_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg4_prop_sum_wall<- vector(length = nrow(spa))
  seg4_prop_neutral_zone<-vector(length = nrow(spa))
  seg4_prop_correct_corner<-vector(length = nrow(spa))
  seg4_prop_incorrect_corner<-vector(length = nrow(spa))
  seg4_prop_correct_platform<- vector(length = nrow(spa))
  seg4_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg4_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg5_prop_sum_wall<- vector(length = nrow(spa))
  seg5_prop_neutral_zone<-vector(length = nrow(spa))
  seg5_prop_correct_corner<-vector(length = nrow(spa))
  seg5_prop_incorrect_corner<-vector(length = nrow(spa))
  seg5_prop_correct_platform<- vector(length = nrow(spa))
  seg5_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg5_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg6_prop_sum_wall<- vector(length = nrow(spa))
  seg6_prop_neutral_zone<-vector(length = nrow(spa))
  seg6_prop_correct_corner<-vector(length = nrow(spa))
  seg6_prop_incorrect_corner<-vector(length = nrow(spa))
  seg6_prop_correct_platform<- vector(length = nrow(spa))
  seg6_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg6_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg7_prop_sum_wall<- vector(length = nrow(spa))
  seg7_prop_neutral_zone<-vector(length = nrow(spa))
  seg7_prop_correct_corner<-vector(length = nrow(spa))
  seg7_prop_incorrect_corner<-vector(length = nrow(spa))
  seg7_prop_correct_platform<- vector(length = nrow(spa))
  seg7_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg7_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg8_prop_sum_wall<- vector(length = nrow(spa))
  seg8_prop_neutral_zone<-vector(length = nrow(spa))
  seg8_prop_correct_corner<-vector(length = nrow(spa))
  seg8_prop_incorrect_corner<-vector(length = nrow(spa))
  seg8_prop_correct_platform<- vector(length = nrow(spa))
  seg8_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg8_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg9_prop_sum_wall<- vector(length = nrow(spa))
  seg9_prop_neutral_zone<-vector(length = nrow(spa))
  seg9_prop_correct_corner<-vector(length = nrow(spa))
  seg9_prop_incorrect_corner<-vector(length = nrow(spa))
  seg9_prop_correct_platform<- vector(length = nrow(spa))
  seg9_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg9_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  seg10_prop_sum_wall<- vector(length = nrow(spa))
  seg10_prop_neutral_zone<-vector(length = nrow(spa))
  seg10_prop_correct_corner<-vector(length = nrow(spa))
  seg10_prop_incorrect_corner<-vector(length = nrow(spa))
  seg10_prop_correct_platform<- vector(length = nrow(spa))
  seg10_prop_incorrect_platform<-vector(length = nrow(spa)) 
  seg10_prop_correct_including_corners_of_corner_and_platform_time<-vector(length = nrow(spa))
  
  spa_left_list<-c("round1", "round2", "round5", "round6")
  spa_right_list<-c("round3", "round4", "round7", "round8")

i<-1
k<-0
for(i in 1:length(file_list)){
  setwd("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/spatial_maze")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)
  filename <- file_list[i]
  filename_trial<-strsplit(filename, "_")[[1]][1]
  filename_round <- strsplit(filename, "_")[[1]][2]
  filename_date <- strsplit(filename, "_")[[1]][3]
  filename_tank <- strsplit(filename, "_")[[1]][4]
  filename_sex <- strsplit(filename, "_")[[1]][5]
  filename_color <- strsplit(filename, "_")[[1]][6]
  filename_time <- strsplit(filename, "_")[[1]][7]
  filename_tank <- strsplit(filename, "_")[[1]][8]
  filename_part <- strsplit(filename, "_")[[1]][9]
  
  if (filename_part == "part1"){
  initial_endtime<-fil$time[nrow(fil)]
  initial_rows<-nrow(fil)
  fil<-rbind(fil, read_csv(file_list[i+1], col_names = TRUE, col_types = NULL))
  j<-1
  for (j in 1:nrow(fil)){
  if (j>initial_rows){
      fil$time[j]<-fil$time[j] + initial_endtime}}
  
  if(fil$code[initial_rows-1]!=fil$code[initial_rows+1]){
    remove_rows<-c(initial_rows)
    fil<-fil[-remove_rows,]}
  if (fil$code[initial_rows-1]==fil$code[initial_rows+1]){
    remove_rows<-c(initial_rows, initial_rows + 1)
    fil<-fil[-remove_rows,]}}
  
  vid_length<-fil$time[nrow(fil)] - fil$time[1]

if (filename_part != "part2" & vid_length >= 600 & filename_trial != "SPA8"){
   k<-k+1

  segment_length<-vid_length/10
  
  fishID<-paste0(filename_round, filename_sex, filename_color, collapse="")
  round<-filename_round
  stamp1<-fil$time[1]
  stamp2<-fil$time[1] + segment_length
  stamp3<-fil$time[1] + (segment_length*2)
  stamp4<-fil$time[1] + (segment_length*3)
  stamp5<-fil$time[1] + (segment_length*4)
  stamp6<-fil$time[1] + (segment_length*5)
  stamp7<-fil$time[1] + (segment_length*6)
  stamp8<-fil$time[1] + (segment_length*7)
  stamp9<-fil$time[1] + (segment_length*8)
  stamp10<-fil$time[1] + (segment_length*9)
  
  segment1<-fil[2:max(which(fil$time<stamp2)),]
  segment2<-fil[(which(fil$time>stamp2)-1):max(which(fil$time<stamp3)),]
  segment3<-fil[(which(fil$time>stamp3)-1):max(which(fil$time<stamp4)),]
  segment4<-fil[(which(fil$time>stamp4)-1):max(which(fil$time<stamp5)),]
  segment5<-fil[(which(fil$time>stamp5)-1):max(which(fil$time<stamp6)),]
  segment6<-fil[(which(fil$time>stamp6)-1):max(which(fil$time<stamp7)),]
  segment7<-fil[(which(fil$time>stamp7)-1):max(which(fil$time<stamp8)),]
  segment8<-fil[(which(fil$time>stamp8)-1):max(which(fil$time<stamp9)),]
  segment9<-fil[(which(fil$time>stamp9)-1):max(which(fil$time<stamp10)),]
  segment10<-fil[(which(fil$time>stamp10)-1):nrow(fil),]
  
  segment1$time[1]<-stamp1
  segment2$time[1]<-stamp2
  segment3$time[1]<-stamp3
  segment4$time[1]<-stamp4
  segment5$time[1]<-stamp5
  segment6$time[1]<-stamp6
  segment7$time[1]<-stamp7
  segment8$time[1]<-stamp8
  segment9$time[1]<-stamp9
  segment10$time[1]<-stamp10
  
  segment1<-mutate(segment1, time.difference = -(time -lead(time)))
  segment1$time.difference[nrow(segment1)]<- (segment_length + segment1$time[1]) - segment1$time[nrow(segment1)]
  segment2<-mutate(segment2, time.difference = -(time -lead(time)))
  segment2$time.difference[nrow(segment2)]<- (segment_length + segment2$time[1]) - segment2$time[nrow(segment2)]
  segment3<-mutate(segment3, time.difference = -(time -lead(time)))
  segment3$time.difference[nrow(segment3)]<- (segment_length + segment3$time[1]) - segment3$time[nrow(segment3)]
  segment4<-mutate(segment4, time.difference = -(time -lead(time)))
  segment4$time.difference[nrow(segment4)]<- (segment_length + segment4$time[1]) - segment4$time[nrow(segment4)]
  segment5<-mutate(segment5, time.difference = -(time -lead(time)))
  segment5$time.difference[nrow(segment5)]<- (segment_length + segment5$time[1]) - segment5$time[nrow(segment5)]
  segment6<-mutate(segment6, time.difference = -(time -lead(time)))
  segment6$time.difference[nrow(segment6)]<- (segment_length + segment6$time[1]) - segment6$time[nrow(segment6)]
  segment7<-mutate(segment7, time.difference = -(time -lead(time)))
  segment7$time.difference[nrow(segment7)]<- (segment_length + segment7$time[1]) - segment7$time[nrow(segment7)]
  segment8<-mutate(segment8, time.difference = -(time -lead(time)))
  segment8$time.difference[nrow(segment8)]<- (segment_length + segment8$time[1]) - segment8$time[nrow(segment8)]
  segment9<-mutate(segment9, time.difference = -(time -lead(time)))
  segment9$time.difference[nrow(segment9)]<- (segment_length + segment9$time[1]) - segment9$time[nrow(segment9)]
  segment10<-mutate(segment10, time.difference = -(time -lead(time)))
  segment10$time.difference[nrow(segment10)]<- (segment_length + segment10$time[1]) - segment10$time[nrow(segment10)]
  
   sexlist[k]<-filename_sex
   statuslist[k]<-NA

  
  if (filename_round %in% spa_right_list){
  seg1_prop_sum_wall[k]<- segment1 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_neutral_zone[k]<-segment1 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_correct_corner[k]<-segment1 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_incorrect_corner[k]<-segment1 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_correct_platform[k]<- segment1 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_incorrect_platform[k]<- segment1 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg1_prop_correct_corner[k] + seg1_prop_correct_platform[k]) / (seg1_prop_correct_corner[k] + seg1_prop_correct_platform[k] + seg1_prop_incorrect_corner[k] + seg1_prop_incorrect_platform[k])
    seg2_prop_sum_wall[k]<- segment2 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_neutral_zone[k]<-segment2 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_correct_corner[k]<-segment2 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_incorrect_corner[k]<-segment2 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_correct_platform[k]<- segment2 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_incorrect_platform[k]<- segment2 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg2_prop_correct_corner[k] + seg2_prop_correct_platform[k]) / (seg2_prop_correct_corner[k] + seg2_prop_correct_platform[k] + seg2_prop_incorrect_corner[k] + seg2_prop_incorrect_platform[k]) 
    seg3_prop_sum_wall[k]<- segment3 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_neutral_zone[k]<-segment3 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_correct_corner[k]<-segment3 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_incorrect_corner[k]<-segment3 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_correct_platform[k]<- segment3 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_incorrect_platform[k]<- segment3 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg3_prop_correct_corner[k] + seg3_prop_correct_platform[k]) / (seg3_prop_correct_corner[k] + seg3_prop_correct_platform[k] + seg3_prop_incorrect_corner[k] + seg3_prop_incorrect_platform[k])
    seg4_prop_sum_wall[k]<- segment4 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_neutral_zone[k]<-segment4 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_correct_corner[k]<-segment4 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_incorrect_corner[k]<-segment4 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_correct_platform[k]<- segment4 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_incorrect_platform[k]<- segment4 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg4_prop_correct_corner[k] + seg4_prop_correct_platform[k]) / (seg4_prop_correct_corner[k] + seg4_prop_correct_platform[k] + seg4_prop_incorrect_corner[k] + seg4_prop_incorrect_platform[k])
    seg5_prop_sum_wall[k]<- segment5 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_neutral_zone[k]<-segment5 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_correct_corner[k]<-segment5 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_incorrect_corner[k]<-segment5 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_correct_platform[k]<- segment5 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_incorrect_platform[k]<- segment5 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg5_prop_correct_corner[k] + seg5_prop_correct_platform[k]) / (seg5_prop_correct_corner[k] + seg5_prop_correct_platform[k] + seg5_prop_incorrect_corner[k] + seg5_prop_incorrect_platform[k])
    seg6_prop_sum_wall[k]<- segment6 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_neutral_zone[k]<-segment6 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_correct_corner[k]<-segment6 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_incorrect_corner[k]<-segment6 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_correct_platform[k]<- segment6 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_incorrect_platform[k]<- segment6 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg6_prop_correct_corner[k] + seg6_prop_correct_platform[k]) / (seg6_prop_correct_corner[k] + seg6_prop_correct_platform[k] + seg6_prop_incorrect_corner[k] + seg6_prop_incorrect_platform[k])
    seg7_prop_sum_wall[k]<- segment7 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_neutral_zone[k]<-segment7 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_correct_corner[k]<-segment7 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_incorrect_corner[k]<-segment7 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_correct_platform[k]<- segment7 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_incorrect_platform[k]<- segment7 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg7_prop_correct_corner[k] + seg7_prop_correct_platform[k]) / (seg7_prop_correct_corner[k] + seg7_prop_correct_platform[k] + seg7_prop_incorrect_corner[k] + seg7_prop_incorrect_platform[k])
    seg8_prop_sum_wall[k]<- segment8 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_neutral_zone[k]<-segment8 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_correct_corner[k]<-segment8 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_incorrect_corner[k]<-segment8 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_correct_platform[k]<- segment8 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_incorrect_platform[k]<- segment8 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg8_prop_correct_corner[k] + seg8_prop_correct_platform[k]) / (seg8_prop_correct_corner[k] + seg8_prop_correct_platform[k] + seg8_prop_incorrect_corner[k] + seg8_prop_incorrect_platform[k])
    seg9_prop_sum_wall[k]<- segment9 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_neutral_zone[k]<-segment9 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_correct_corner[k]<-segment9 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_incorrect_corner[k]<-segment9 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_correct_platform[k]<- segment9 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_incorrect_platform[k]<- segment9 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg9_prop_correct_corner[k] + seg9_prop_correct_platform[k]) / (seg9_prop_correct_corner[k] + seg9_prop_correct_platform[k] + seg9_prop_incorrect_corner[k] + seg9_prop_incorrect_platform[k])
    seg10_prop_sum_wall[k]<- segment10 %>% filter(code == "right_wall"|code == "left_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_neutral_zone[k]<-segment10 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_correct_corner[k]<-segment10 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_incorrect_corner[k]<-segment10 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_correct_platform[k]<- segment10 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_incorrect_platform[k]<- segment10 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg10_prop_correct_corner[k] + seg10_prop_correct_platform[k]) / (seg10_prop_correct_corner[k] + seg10_prop_correct_platform[k] + seg10_prop_incorrect_corner[k] + seg10_prop_incorrect_platform[k])}
                                                                                                                               
  if (filename_round %in% spa_left_list){
  seg1_prop_sum_wall[k]<- segment1 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_neutral_zone[k]<-segment1 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_correct_corner[k]<-segment1 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_incorrect_corner[k]<-segment1 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_correct_platform[k]<- segment1 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_incorrect_platform[k]<- segment1 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg1_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg1_prop_correct_corner[k] + seg1_prop_correct_platform[k]) / (seg1_prop_correct_corner[k] + seg1_prop_correct_platform[k] + seg1_prop_incorrect_corner[k] + seg1_prop_incorrect_platform[k])
    seg2_prop_sum_wall[k]<- segment2 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_neutral_zone[k]<-segment2 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_correct_corner[k]<-segment2 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_incorrect_corner[k]<-segment2 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_correct_platform[k]<- segment2 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_incorrect_platform[k]<- segment2 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg2_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg2_prop_correct_corner[k] + seg2_prop_correct_platform[k]) / (seg2_prop_correct_corner[k] + seg2_prop_correct_platform[k] + seg2_prop_incorrect_corner[k] + seg2_prop_incorrect_platform[k]) 
    seg3_prop_sum_wall[k]<- segment3 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_neutral_zone[k]<-segment3 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_correct_corner[k]<-segment3 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_incorrect_corner[k]<-segment3 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_correct_platform[k]<- segment3 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_incorrect_platform[k]<- segment3 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg3_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg3_prop_correct_corner[k] + seg3_prop_correct_platform[k]) / (seg3_prop_correct_corner[k] + seg3_prop_correct_platform[k] + seg3_prop_incorrect_corner[k] + seg3_prop_incorrect_platform[k])
    seg4_prop_sum_wall[k]<- segment4 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_neutral_zone[k]<-segment4 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_correct_corner[k]<-segment4 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_incorrect_corner[k]<-segment4 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_correct_platform[k]<- segment4 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_incorrect_platform[k]<- segment4 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg4_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg4_prop_correct_corner[k] + seg4_prop_correct_platform[k]) / (seg4_prop_correct_corner[k] + seg4_prop_correct_platform[k] + seg4_prop_incorrect_corner[k] + seg4_prop_incorrect_platform[k])
    seg5_prop_sum_wall[k]<- segment5 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_neutral_zone[k]<-segment5 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_correct_corner[k]<-segment5 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_incorrect_corner[k]<-segment5 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_correct_platform[k]<- segment5 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_incorrect_platform[k]<- segment5 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg5_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg5_prop_correct_corner[k] + seg5_prop_correct_platform[k]) / (seg5_prop_correct_corner[k] + seg5_prop_correct_platform[k] + seg5_prop_incorrect_corner[k] + seg5_prop_incorrect_platform[k])
    seg6_prop_sum_wall[k]<- segment6 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_neutral_zone[k]<-segment6 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_correct_corner[k]<-segment6 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_incorrect_corner[k]<-segment6 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_correct_platform[k]<- segment6 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_incorrect_platform[k]<- segment6 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg6_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg6_prop_correct_corner[k] + seg6_prop_correct_platform[k]) / (seg6_prop_correct_corner[k] + seg6_prop_correct_platform[k] + seg6_prop_incorrect_corner[k] + seg6_prop_incorrect_platform[k])
    seg7_prop_sum_wall[k]<- segment7 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_neutral_zone[k]<-segment7 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_correct_corner[k]<-segment7 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_incorrect_corner[k]<-segment7 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_correct_platform[k]<- segment7 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_incorrect_platform[k]<- segment7 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg7_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg7_prop_correct_corner[k] + seg7_prop_correct_platform[k]) / (seg7_prop_correct_corner[k] + seg7_prop_correct_platform[k] + seg7_prop_incorrect_corner[k] + seg7_prop_incorrect_platform[k])
    seg8_prop_sum_wall[k]<- segment8 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_neutral_zone[k]<-segment8 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_correct_corner[k]<-segment8 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_incorrect_corner[k]<-segment8 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_correct_platform[k]<- segment8 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_incorrect_platform[k]<- segment8 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg8_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg8_prop_correct_corner[k] + seg8_prop_correct_platform[k]) / (seg8_prop_correct_corner[k] + seg8_prop_correct_platform[k] + seg8_prop_incorrect_corner[k] + seg8_prop_incorrect_platform[k])
    seg9_prop_sum_wall[k]<- segment9 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_neutral_zone[k]<-segment9 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_correct_corner[k]<-segment9 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_incorrect_corner[k]<-segment9 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_correct_platform[k]<- segment9 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_incorrect_platform[k]<- segment9 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg9_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg9_prop_correct_corner[k] + seg9_prop_correct_platform[k]) / (seg9_prop_correct_corner[k] + seg9_prop_correct_platform[k] + seg9_prop_incorrect_corner[k] + seg9_prop_incorrect_platform[k])
    seg10_prop_sum_wall[k]<- segment10 %>% filter(code == "left_wall"|code == "right_wall"|code=="back_wall") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_neutral_zone[k]<-segment10 %>% filter(code == "neutral_zone") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_correct_corner[k]<-segment10 %>% filter(code == "left_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_incorrect_corner[k]<-segment10 %>% filter(code == "right_corner") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_correct_platform[k]<- segment10 %>% filter(code == "left_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_incorrect_platform[k]<- segment10 %>% filter(code == "right_platform") %>% pull(time.difference) %>% sum()/segment_length
  seg10_prop_correct_including_corners_of_corner_and_platform_time[k]<-(seg10_prop_correct_corner[k] + seg10_prop_correct_platform[k]) / (seg10_prop_correct_corner[k] + seg10_prop_correct_platform[k] + seg10_prop_incorrect_corner[k] + seg10_prop_incorrect_platform[k])}
  
}}  


#FEMALES
  seg1_fprop_sum_wall<- seg1_prop_sum_wall[which(sexlist == "female")]
  seg1_fprop_neutral_zone<-seg1_prop_neutral_zone[which(sexlist == "female")]
  seg1_fprop_correct_corner<-seg1_prop_correct_corner[which(sexlist == "female")]
  seg1_fprop_incorrect_corner<-seg1_prop_incorrect_corner[which(sexlist == "female")]
  seg1_fprop_correct_platform<- seg1_prop_correct_platform[which(sexlist == "female")]
  seg1_fprop_incorrect_platform<- seg1_prop_incorrect_platform[which(sexlist == "female")]
  seg1_fprop_correct_including_corners_of_corner_and_platform_time<-seg1_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg2_fprop_sum_wall<- seg2_prop_sum_wall[which(sexlist == "female")]
  seg2_fprop_neutral_zone<-seg2_prop_neutral_zone[which(sexlist == "female")]
  seg2_fprop_correct_corner<-seg2_prop_correct_corner[which(sexlist == "female")]
  seg2_fprop_incorrect_corner<-seg2_prop_incorrect_corner[which(sexlist == "female")]
  seg2_fprop_correct_platform<- seg2_prop_correct_platform[which(sexlist == "female")]
  seg2_fprop_incorrect_platform<- seg2_prop_incorrect_platform[which(sexlist == "female")]
  seg2_fprop_correct_including_corners_of_corner_and_platform_time<-seg2_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg3_fprop_sum_wall<- seg3_prop_sum_wall[which(sexlist == "female")]
  seg3_fprop_neutral_zone<-seg3_prop_neutral_zone[which(sexlist == "female")]
  seg3_fprop_correct_corner<-seg3_prop_correct_corner[which(sexlist == "female")]
  seg3_fprop_incorrect_corner<-seg3_prop_incorrect_corner[which(sexlist == "female")]
  seg3_fprop_correct_platform<- seg3_prop_correct_platform[which(sexlist == "female")]
  seg3_fprop_incorrect_platform<- seg3_prop_incorrect_platform[which(sexlist == "female")]
  seg3_fprop_correct_including_corners_of_corner_and_platform_time<-seg3_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg4_fprop_sum_wall<- seg4_prop_sum_wall[which(sexlist == "female")]
  seg4_fprop_neutral_zone<-seg4_prop_neutral_zone[which(sexlist == "female")]
  seg4_fprop_correct_corner<-seg4_prop_correct_corner[which(sexlist == "female")]
  seg4_fprop_incorrect_corner<-seg4_prop_incorrect_corner[which(sexlist == "female")]
  seg4_fprop_correct_platform<- seg4_prop_correct_platform[which(sexlist == "female")]
  seg4_fprop_incorrect_platform<- seg4_prop_incorrect_platform[which(sexlist == "female")]
  seg4_fprop_correct_including_corners_of_corner_and_platform_time<-seg4_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg5_fprop_sum_wall<- seg5_prop_sum_wall[which(sexlist == "female")]
  seg5_fprop_neutral_zone<-seg5_prop_neutral_zone[which(sexlist == "female")]
  seg5_fprop_correct_corner<-seg5_prop_correct_corner[which(sexlist == "female")]
  seg5_fprop_incorrect_corner<-seg5_prop_incorrect_corner[which(sexlist == "female")]
  seg5_fprop_correct_platform<- seg5_prop_correct_platform[which(sexlist == "female")]
  seg5_fprop_incorrect_platform<- seg5_prop_incorrect_platform[which(sexlist == "female")]
  seg5_fprop_correct_including_corners_of_corner_and_platform_time<-seg5_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg6_fprop_sum_wall<- seg6_prop_sum_wall[which(sexlist == "female")]
  seg6_fprop_neutral_zone<-seg6_prop_neutral_zone[which(sexlist == "female")]
  seg6_fprop_correct_corner<-seg6_prop_correct_corner[which(sexlist == "female")]
  seg6_fprop_incorrect_corner<-seg6_prop_incorrect_corner[which(sexlist == "female")]
  seg6_fprop_correct_platform<- seg6_prop_correct_platform[which(sexlist == "female")]
  seg6_fprop_incorrect_platform<- seg6_prop_incorrect_platform[which(sexlist == "female")]
  seg6_fprop_correct_including_corners_of_corner_and_platform_time<-seg6_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg7_fprop_sum_wall<- seg7_prop_sum_wall[which(sexlist == "female")]
  seg7_fprop_neutral_zone<-seg7_prop_neutral_zone[which(sexlist == "female")]
  seg7_fprop_correct_corner<-seg7_prop_correct_corner[which(sexlist == "female")]
  seg7_fprop_incorrect_corner<-seg7_prop_incorrect_corner[which(sexlist == "female")]
  seg7_fprop_correct_platform<- seg7_prop_correct_platform[which(sexlist == "female")]
  seg7_fprop_incorrect_platform<- seg7_prop_incorrect_platform[which(sexlist == "female")]
  seg7_fprop_correct_including_corners_of_corner_and_platform_time<-seg7_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg8_fprop_sum_wall<- seg8_prop_sum_wall[which(sexlist == "female")]
  seg8_fprop_neutral_zone<-seg8_prop_neutral_zone[which(sexlist == "female")]
  seg8_fprop_correct_corner<-seg8_prop_correct_corner[which(sexlist == "female")]
  seg8_fprop_incorrect_corner<-seg8_prop_incorrect_corner[which(sexlist == "female")]
  seg8_fprop_correct_platform<- seg8_prop_correct_platform[which(sexlist == "female")]
  seg8_fprop_incorrect_platform<- seg8_prop_incorrect_platform[which(sexlist == "female")]
  seg8_fprop_correct_including_corners_of_corner_and_platform_time<-seg8_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg9_fprop_sum_wall<- seg9_prop_sum_wall[which(sexlist == "female")]
  seg9_fprop_neutral_zone<-seg9_prop_neutral_zone[which(sexlist == "female")]
  seg9_fprop_correct_corner<-seg9_prop_correct_corner[which(sexlist == "female")]
  seg9_fprop_incorrect_corner<-seg9_prop_incorrect_corner[which(sexlist == "female")]
  seg9_fprop_correct_platform<- seg9_prop_correct_platform[which(sexlist == "female")]
  seg9_fprop_incorrect_platform<- seg9_prop_incorrect_platform[which(sexlist == "female")]
  seg9_fprop_correct_including_corners_of_corner_and_platform_time<-seg9_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  seg10_fprop_sum_wall<- seg10_prop_sum_wall[which(sexlist == "female")]
  seg10_fprop_neutral_zone<-seg10_prop_neutral_zone[which(sexlist == "female")]
  seg10_fprop_correct_corner<-seg10_prop_correct_corner[which(sexlist == "female")]
  seg10_fprop_incorrect_corner<-seg10_prop_incorrect_corner[which(sexlist == "female")]
  seg10_fprop_correct_platform<- seg10_prop_correct_platform[which(sexlist == "female")]
  seg10_fprop_incorrect_platform<- seg10_prop_incorrect_platform[which(sexlist == "female")]
  seg10_fprop_correct_including_corners_of_corner_and_platform_time<-seg10_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "female")]
  
  
i<-1
for (i in 1:10){
fullframef$segment[i]<-i
fullframef$prop_sum_wall[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_sum_wall", sep = ""))), na.rm = TRUE)*100
fullframef$prop_neutral_zone[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_neutral_zone", sep = ""))), na.rm = TRUE)*100
fullframef$prop_correct_corner[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_correct_corner", sep = ""))), na.rm = TRUE)*100
fullframef$prop_incorrect_corner[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_incorrect_corner", sep = ""))), na.rm = TRUE)*100
fullframef$prop_correct_platform[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_correct_platform", sep = ""))), na.rm = TRUE)*100
fullframef$prop_incorrect_platform[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_incorrect_platform", sep = ""))), na.rm = TRUE)*100
fullframef$prop_correct_including_corners_of_corner_and_platform_time[i]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_correct_including_corners_of_corner_and_platform_time", sep = ""))), na.rm = TRUE)*100
}


fullframevaluef<-(vector(length = 60))
k<-1
i<-1
for (i in 1:10){
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_sum_wall", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_neutral_zone", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_correct_corner", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_incorrect_corner", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_correct_platform", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluef[k]<-mean(eval(parse(text = paste("seg", {i}, "_fprop_incorrect_platform", sep = ""))), na.rm = TRUE)*100
k<-k+1}



#MALES
  seg1_mprop_sum_wall<- seg1_prop_sum_wall[which(sexlist == "male")]
  seg1_mprop_neutral_zone<-seg1_prop_neutral_zone[which(sexlist == "male")]
  seg1_mprop_correct_corner<-seg1_prop_correct_corner[which(sexlist == "male")]
  seg1_mprop_incorrect_corner<-seg1_prop_incorrect_corner[which(sexlist == "male")]
  seg1_mprop_correct_platform<- seg1_prop_correct_platform[which(sexlist == "male")]
  seg1_mprop_incorrect_platform<- seg1_prop_incorrect_platform[which(sexlist == "male")]
  seg1_mprop_correct_including_corners_of_corner_and_platform_time<-seg1_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg2_mprop_sum_wall<- seg2_prop_sum_wall[which(sexlist == "male")]
  seg2_mprop_neutral_zone<-seg2_prop_neutral_zone[which(sexlist == "male")]
  seg2_mprop_correct_corner<-seg2_prop_correct_corner[which(sexlist == "male")]
  seg2_mprop_incorrect_corner<-seg2_prop_incorrect_corner[which(sexlist == "male")]
  seg2_mprop_correct_platform<- seg2_prop_correct_platform[which(sexlist == "male")]
  seg2_mprop_incorrect_platform<- seg2_prop_incorrect_platform[which(sexlist == "male")]
  seg2_mprop_correct_including_corners_of_corner_and_platform_time<-seg2_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg3_mprop_sum_wall<- seg3_prop_sum_wall[which(sexlist == "male")]
  seg3_mprop_neutral_zone<-seg3_prop_neutral_zone[which(sexlist == "male")]
  seg3_mprop_correct_corner<-seg3_prop_correct_corner[which(sexlist == "male")]
  seg3_mprop_incorrect_corner<-seg3_prop_incorrect_corner[which(sexlist == "male")]
  seg3_mprop_correct_platform<- seg3_prop_correct_platform[which(sexlist == "male")]
  seg3_mprop_incorrect_platform<- seg3_prop_incorrect_platform[which(sexlist == "male")]
  seg3_mprop_correct_including_corners_of_corner_and_platform_time<-seg3_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg4_mprop_sum_wall<- seg4_prop_sum_wall[which(sexlist == "male")]
  seg4_mprop_neutral_zone<-seg4_prop_neutral_zone[which(sexlist == "male")]
  seg4_mprop_correct_corner<-seg4_prop_correct_corner[which(sexlist == "male")]
  seg4_mprop_incorrect_corner<-seg4_prop_incorrect_corner[which(sexlist == "male")]
  seg4_mprop_correct_platform<- seg4_prop_correct_platform[which(sexlist == "male")]
  seg4_mprop_incorrect_platform<- seg4_prop_incorrect_platform[which(sexlist == "male")]
  seg4_mprop_correct_including_corners_of_corner_and_platform_time<-seg4_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg5_mprop_sum_wall<- seg5_prop_sum_wall[which(sexlist == "male")]
  seg5_mprop_neutral_zone<-seg5_prop_neutral_zone[which(sexlist == "male")]
  seg5_mprop_correct_corner<-seg5_prop_correct_corner[which(sexlist == "male")]
  seg5_mprop_incorrect_corner<-seg5_prop_incorrect_corner[which(sexlist == "male")]
  seg5_mprop_correct_platform<- seg5_prop_correct_platform[which(sexlist == "male")]
  seg5_mprop_incorrect_platform<- seg5_prop_incorrect_platform[which(sexlist == "male")]
  seg5_mprop_correct_including_corners_of_corner_and_platform_time<-seg5_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg6_mprop_sum_wall<- seg6_prop_sum_wall[which(sexlist == "male")]
  seg6_mprop_neutral_zone<-seg6_prop_neutral_zone[which(sexlist == "male")]
  seg6_mprop_correct_corner<-seg6_prop_correct_corner[which(sexlist == "male")]
  seg6_mprop_incorrect_corner<-seg6_prop_incorrect_corner[which(sexlist == "male")]
  seg6_mprop_correct_platform<- seg6_prop_correct_platform[which(sexlist == "male")]
  seg6_mprop_incorrect_platform<- seg6_prop_incorrect_platform[which(sexlist == "male")]
  seg6_mprop_correct_including_corners_of_corner_and_platform_time<-seg6_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg7_mprop_sum_wall<- seg7_prop_sum_wall[which(sexlist == "male")]
  seg7_mprop_neutral_zone<-seg7_prop_neutral_zone[which(sexlist == "male")]
  seg7_mprop_correct_corner<-seg7_prop_correct_corner[which(sexlist == "male")]
  seg7_mprop_incorrect_corner<-seg7_prop_incorrect_corner[which(sexlist == "male")]
  seg7_mprop_correct_platform<- seg7_prop_correct_platform[which(sexlist == "male")]
  seg7_mprop_incorrect_platform<- seg7_prop_incorrect_platform[which(sexlist == "male")]
  seg7_mprop_correct_including_corners_of_corner_and_platform_time<-seg7_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg8_mprop_sum_wall<- seg8_prop_sum_wall[which(sexlist == "male")]
  seg8_mprop_neutral_zone<-seg8_prop_neutral_zone[which(sexlist == "male")]
  seg8_mprop_correct_corner<-seg8_prop_correct_corner[which(sexlist == "male")]
  seg8_mprop_incorrect_corner<-seg8_prop_incorrect_corner[which(sexlist == "male")]
  seg8_mprop_correct_platform<- seg8_prop_correct_platform[which(sexlist == "male")]
  seg8_mprop_incorrect_platform<- seg8_prop_incorrect_platform[which(sexlist == "male")]
  seg8_mprop_correct_including_corners_of_corner_and_platform_time<-seg8_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg9_mprop_sum_wall<- seg9_prop_sum_wall[which(sexlist == "male")]
  seg9_mprop_neutral_zone<-seg9_prop_neutral_zone[which(sexlist == "male")]
  seg9_mprop_correct_corner<-seg9_prop_correct_corner[which(sexlist == "male")]
  seg9_mprop_incorrect_corner<-seg9_prop_incorrect_corner[which(sexlist == "male")]
  seg9_mprop_correct_platform<- seg9_prop_correct_platform[which(sexlist == "male")]
  seg9_mprop_incorrect_platform<- seg9_prop_incorrect_platform[which(sexlist == "male")]
  seg9_mprop_correct_including_corners_of_corner_and_platform_time<-seg9_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  seg10_mprop_sum_wall<- seg10_prop_sum_wall[which(sexlist == "male")]
  seg10_mprop_neutral_zone<-seg10_prop_neutral_zone[which(sexlist == "male")]
  seg10_mprop_correct_corner<-seg10_prop_correct_corner[which(sexlist == "male")]
  seg10_mprop_incorrect_corner<-seg10_prop_incorrect_corner[which(sexlist == "male")]
  seg10_mprop_correct_platform<- seg10_prop_correct_platform[which(sexlist == "male")]
  seg10_mprop_incorrect_platform<- seg10_prop_incorrect_platform[which(sexlist == "male")]
  seg10_mprop_correct_including_corners_of_corner_and_platform_time<-seg10_prop_correct_including_corners_of_corner_and_platform_time[which(sexlist == "male")]
  
  
i<-1
for (i in 1:10){
fullframem$segment[i]<-i
fullframem$prop_sum_wall[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_sum_wall", sep = ""))), na.rm = TRUE)*100
fullframem$prop_neutral_zone[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_neutral_zone", sep = ""))), na.rm = TRUE)*100
fullframem$prop_correct_corner[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_correct_corner", sep = ""))), na.rm = TRUE)*100
fullframem$prop_incorrect_corner[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_incorrect_corner", sep = ""))), na.rm = TRUE)*100
fullframem$prop_correct_platform[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_correct_platform", sep = ""))), na.rm = TRUE)*100
fullframem$prop_incorrect_platform[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_incorrect_platform", sep = ""))), na.rm = TRUE)*100
fullframem$prop_correct_including_corners_of_corner_and_platform_time[i]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_correct_including_corners_of_corner_and_platform_time", sep = ""))), na.rm = TRUE)*100
}


fullframevaluem<-(vector(length = 60))
k<-1
i<-1
for (i in 1:10){
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_sum_wall", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_neutral_zone", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_correct_corner", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_incorrect_corner", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_correct_platform", sep = ""))), na.rm = TRUE)*100
k<-k+1
fullframevaluem[k]<-mean(eval(parse(text = paste("seg", {i}, "_mprop_incorrect_platform", sep = ""))), na.rm = TRUE)*100
k<-k+1}

```

############
#running all the PCA's first to keep them in order

#Fig 3 - NOR pca loadings heatmap
```{r, echo = FALSE, message=FALSE, warning=FALSE}

 tempPCAlist<-newnovlist
 factor<-c("fishID", "sex")
 fulltempPCAlist<-append(tempPCAlist, factor)
 temp.df<-df[, which(names(df) %in% fulltempPCAlist)]
 temp.df<-na.omit(temp.df)
 temp.dfnoid<-temp.df[, -which(names(temp.df) %in% factor)]
 
 pca <- prcomp(temp.dfnoid, center = TRUE,scale = TRUE)
 summary(pca)
 novpca<-as.data.frame(pca$x)
 novpca$fishID<-temp.df$fishID
 novpca$sex<-temp.df$sex
 pca.loadings <- pca$rotation
 colnames(novpca)<-c("NOVPC1","NOVPC2","NOVPC3","NOVPC4","NOVPC5","NOVPC6","NOVPC7","NOVPC8","NOVPC9","fishID", "sex")
 
 
 pca.loadings<-as.data.frame(pca.loadings)
 pca.loadings$name<-as.vector(rownames(pca.loadings))
 roworder<-c("NOVprop_sum_alley","NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time","NOVnov_entries","NOVmean_fam_int_bout_duration","NOVfam_entries","NOVprop_sum_interaction","NOVmean_nov_int_bout_duration","NOVprop_sum_corner", "NOVlatency_to_enter_a_interaction") #got this order from the dendrogram below, using this to reorder the rows for the heatmap
 pca.loadings<-pca.loadings%>%mutate(name =  factor(name, levels = roworder)) %>%
  arrange(name)
 pca.loadings$name<-roworder
 row.names(pca.loadings) <- roworder
 drops<-"name"
 pca.loadings<-pca.loadings[ , !(names(pca.loadings) %in% drops)]
pca.loadings<-as.matrix(pca.loadings)
 plot(fviz_eig(pca, addlabels=TRUE, geom="bar")) +theme_classic()
 Colors=rev(brewer.pal(11,"RdBu"))

#ony show the first 3 axes because they're above 10%
 heatmap.2(pca.loadings, Colv = NA, Rowv = NA, col=Colors,trace="none",density.info="none", xlab = "NOVPC loadings",margins = c(8, 18))
 set.seed(1234)
 hc<- pvclust(t(pca.loadings), method.dist = "correlation", 
            method.hclust = "average", nboot = 100)
 plot(hc, hang = -1, cex = 0.6, lwd = 3:1, labels = F, print.pv=FALSE, print.num=FALSE)
 plot(hc, hang = -1, cex = 0.6, lwd = 3:1)
 pvrect(hc)

```

#Supp 5 - SPA pca loadings heatmap and SPA PC2 boxplot by sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}
tempPCAlist<-spalist
 factor<-c("fishID", "sex")
 fulltempPCAlist<-append(tempPCAlist, factor)
 temp.df<-df[, which(names(df) %in% fulltempPCAlist)]
 temp.df<-na.omit(temp.df)
 temp.dfnoid<-temp.df[, -which(names(temp.df) %in% factor)]
 
 pca <- prcomp(temp.dfnoid, center = TRUE,scale = TRUE)
 summary(pca)
 spapca<-as.data.frame(pca$x)
 spapca$fishID<-temp.df$fishID
 spapca$sex<-temp.df$sex
 pca.loadings <- pca$rotation
 colnames(spapca)<-c("SPAPC1","SPAPC2","SPAPC3","SPAPC4","SPAPC5","SPAPC6","SPAPC7","SPAPC8", "SPAPC9", "SPAPC10","fishID", "sex")
 
 pca.loadings<-as.data.frame(pca.loadings)
 pca.loadings$name<-as.vector(rownames(pca.loadings))
 roworder<-c("SPAprop_sum_platform","SPAlatency_to_enter_a_corner","SPAnumber_of_entries_total","SPAprop_sum_corner","SPAprop_sum_corner_and_platform","SPAprop_correct_including_corners_of_corner_and_platform_time","SPAprop_sum_wall","SPAlatency_to_enter_correct_corner", "SPAlatency_to_enter_a_platform", "SPAprop_correct_including_corners_following_first_correct_corner_entry") #got this order from the dendrogram below, using this to reorder the rows for the heatmap
 pca.loadings<-pca.loadings%>%mutate(name =  factor(name, levels = roworder)) %>%
  arrange(name)
 pca.loadings$name<-roworder
 row.names(pca.loadings) <- roworder
 drops<-"name"
 pca.loadings<-pca.loadings[ , !(names(pca.loadings) %in% drops)]
pca.loadings<-as.matrix(pca.loadings)

 plot(fviz_eig(pca, addlabels=TRUE, geom="bar")+ theme_classic())
  Colors=rev(brewer.pal(11,"RdBu"))
 heatmap.2(pca.loadings, Colv = NA, Rowv = NA, col=Colors,trace="none",density.info="none", xlab = "SPAPC loadings",margins = c(8, 18))
 set.seed(1234)
 hc<- pvclust(t(pca.loadings), method.dist = "correlation", 
            method.hclust = "average", nboot = 100)
 plot(hc, hang = -1, cex = 0.6, lwd = 3:1, labels = F, print.pv=FALSE, print.num=FALSE)
 plot(hc, hang = -1, cex = 0.6, lwd = 3:1)
 pvrect(hc)

pcadf<-full_join(novpca, spapca, by = "fishID")
pcadf$sex<-vector(length = nrow(pcadf))
pcadf$sex <- ifelse(!is.na(pcadf$sex.x), pcadf$sex.x, pcadf$sex.y) # 1= female, 2 = male
pcadf<-pcadf[ , -which(names(pcadf) %in% c("sex.x","sex.y"))]


test_column <- vector(length = nrow(pcadf))
 temp <- data.frame(factor = test_column)
 temp$factor<-pcadf%>%select(sex)
 factor_name<-"sex"
 temp$measure<-pcadf%>%select(SPAPC2)
 measure_name<-"SPAPC2"
 temp<-as.matrix(temp)
 temp<-as.data.frame(temp)
 temp$measure<-as.numeric(as.character(temp$measure))
 temp<- temp %>% filter(is.na(factor)==FALSE) %>% filter(is.na(measure)==FALSE)
 miny<-min(temp$measure)

 shapiro_test<-shapiro.test(temp$measure) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 p_value_wilcox<-NA

 wilcox_test<-wilcox.test(temp$measure~temp$factor)
 p_value_wilcox<-wilcox_test$p.value
 p_value_wilcoxadj<-p.adjust(p_value_wilcox, method = "fdr", n = 10)
 print(paste("does", measure_name ,"differ by", factor_name, "? wilcox p value FDR corrected (10) = ", round(p_value_wilcoxadj,4)))
  cohen<-cohen.d(temp$measure~temp$factor)
 cohen<-abs(cohen$estimate)
 print("cohen")
print(cohen)

 temp$factor<-as.character(temp$factor)
 p<- ggplot(temp, aes(x=temp$factor, y=temp$measure)) +
   geom_boxplot(lwd=1, fill = c("gray75", "gray95"))+
   theme_classic()+
   labs(x= factor_name,y=measure_name) + theme(axis.text.y = element_text(size = 14)) + theme(axis.text.x = element_text(size = 14)) +
   stat_n_text(size = 5)+
   geom_text(x=2, y=4, label= glue::glue("p(wilcox) FDR  (10)= 
                                          {round(p_value_wilcoxadj,4)}
                                         cohen's d = {round(cohen,4)}"), size = 3, color = "gray27", fontface = 'italic')
 plot(p)
```

#Fig 7 - combined PCA loadings heatmap
```{r, echo = FALSE, message=FALSE, warning=FALSE}

 tempPCAlist<-fullcontinuouslist
 factor<-c("fishID", "sex")
 fulltempPCAlist<-append(tempPCAlist, factor)
 temp.df<-df[, which(names(df) %in% fulltempPCAlist)]
 temp.df<-na.omit(temp.df)
 temp.dfnoid<-temp.df[, -which(names(temp.df) %in% factor)]
 
 pca <- prcomp(temp.dfnoid, center = TRUE,scale = TRUE)
 summary(pca)
 fullpca<-as.data.frame(pca$x)
 fullpca$fishID<-temp.df$fishID
 fullpca$sex<-temp.df$sex
 pca.loadings <- pca$rotation
 
pca.loadings<-as.matrix(pca.loadings)
 plot(fviz_eig(pca, addlabels=TRUE, geom="bar")+ theme_classic())
 
pca.loadings<-as.data.frame(pca.loadings)
 pca.loadings$name<-as.vector(rownames(pca.loadings))
 roworder<-c(
   
   
   
   "NOVprop_sum_corner",
   "NOVnov_entries",
   "SPAprop_sum_platform",
   "SPAprop_sum_wall",
   "SPAnumber_of_entries_total",
   "NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time",
   "NOVfam_entries",
   "NOVprop_sum_interaction",
   "NOVmean_fam_int_bout_duration",
   "SPAlatency_to_enter_correct_corner",
   "NOVlatency_to_enter_a_interaction",
   "SPAlatency_to_enter_a_corner",
   "NOVprop_sum_alley",
   "SPAlatency_to_enter_a_platform",
   "SPAprop_sum_corner",
   "NOVmean_nov_int_bout_duration",
   "SPAprop_sum_corner_and_platform",
   "SPAprop_correct_including_corners_of_corner_and_platform_time",
   "SPAprop_correct_including_corners_following_first_correct_corner_entry") 
#got this order from the dendrogram below, using this to reorder the rows for the heatmap
 pca.loadings<-pca.loadings%>%mutate(name =  factor(name, levels = roworder)) %>%
  arrange(name)
 pca.loadings$name<-roworder
 row.names(pca.loadings) <- roworder
 drops<-"name"
 pca.loadings<-pca.loadings[ , !(names(pca.loadings) %in% drops)]
 
 #now filtering fullpca and pca.loadings so there's only the first 4 PC's (the PC's that are above 10% of the variation)
 pca.loadings<-as.data.frame(pca.loadings)
 pca.loadings<-pca.loadings %>% select(c("PC1", "PC2", "PC3", "PC4"))
 pca.loadings<-as.matrix(pca.loadings)
 
 
 fullpca<-fullpca%>% select(c("PC1", "PC2", "PC3", "PC4", "sex"))
 fullpcanosex<-fullpca %>% select(c("PC1", "PC2", "PC3", "PC4"))
 fullpcanosex<-as.matrix(fullpcanosex)
 
 Colors=rev(brewer.pal(11,"RdBu"))
 heatmap.2(pca.loadings, Colv = NA, Rowv = NA, col=Colors,trace="none",density.info="none", xlab = "FULL PC loadings",margins = c(8, 18))
 set.seed(1234)
 hc<- pvclust(t(pca.loadings), method.dist = "correlation", 
            method.hclust = "average", nboot = 100)
 plot(hc, hang = -1, cex = 0.6, lwd = 3:1, labels = F, print.pv=FALSE, print.num=FALSE)
 plot(hc, hang = -1, cex = 0.6, lwd = 3:1)
 pvrect(hc)

```

############
#Fig 2C - NOR association time stacked bar graph by sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}
zones<-rep(c( "corner","interaction","alley"), 2)
sex<-c(rep(c("female"),3), rep(c("male"),3))
fpct<-c(mean(df.female$NOVprop_sum_alley, na.rm = TRUE), mean(df.female$NOVprop_sum_corner, na.rm = TRUE), mean(df.female$NOVprop_sum_interaction, na.rm = TRUE))
fpct<-fpct * 100
mpct<-c(mean(df.male$NOVprop_sum_alley, na.rm = TRUE), mean(df.male$NOVprop_sum_corner, na.rm = TRUE), mean(df.male$NOVprop_sum_interaction, na.rm = TRUE))
mpct<-mpct * 100
fpct<-round(fpct)
mpct<-round(mpct)
pct<-append(fpct,mpct)

shapiro_test<-shapiro.test(df$NOVprop_sum_corner) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$NOVprop_sum_corner~df$sex)
 p_value_wilcox<-wilcox_test$p.value
 print(paste("does nov % corner differ by sex? wilcox p value = ", round(p_value_wilcox,4)))
 cohen<-cohen.d(df$NOVprop_sum_corner~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(NOVprop_sum_corner) == FALSE) %>% filter(is.na(sex) == FALSE) %>% nrow()
 
 data <- data.frame(zones,sex, pct)
ggplot(data, aes(fill=zones, y=pct, x=sex)) + 
    geom_bar(position="stack", stat="identity", width = 0.7) + 
  theme(aspect.ratio = 1.6/1) +
  ggtitle("nov- sum corner p = 0.0222 cohen's d = 0.482")+
  scale_fill_manual(values=c("turquoise3","dodgerblue4","tomato2")) 
 
 
```

#Fig 2B - NOR familiar preference segment 1 (60 seconds) stacked bar graph
```{r, echo = FALSE, message=FALSE, warning=FALSE}

#stacked bar graph of preference during 1st minute

  zones<-rep(c("zfamiliar" , "novel"), 2)
sex<-c(rep(c("female"),2), rep(c("male"),2))
fpct<-c(mean(seg1_fpreference_familiar_corner_and_interaction, na.rm = TRUE), 1-mean(seg1_fpreference_familiar_corner_and_interaction, na.rm = TRUE))
mpct<-c(mean(seg1_mpreference_familiar_corner_and_interaction, na.rm = TRUE), 1-mean(seg1_mpreference_familiar_corner_and_interaction, na.rm = TRUE))
pct<-append(fpct,mpct)
print(pct)
 data <- data.frame(zones,sex, pct)
ggplot(data, aes(fill=zones, y=pct, x=sex)) + 
    geom_bar(position="stack", stat="identity", width = 0.7) + 
  theme(aspect.ratio = 1.6/1) +
  ggtitle("nov familiar preference")+
  scale_fill_manual(values=c("red", "blue")) +theme_classic()+
  scale_fill_manual(values=c("turquoise3","dodgerblue4")) +
  theme(aspect.ratio = 1.6/1)+
  geom_hline(yintercept = 0.5, linetype="dashed", color = "gray70")
# 
# tempf<-as.data.frame(vector(length =(length(seg1_fpreference_familiar_corner_and_interaction))))
# tempf$pref<-seg1_fpreference_familiar_corner_and_interaction
# tempf$sex<-"female"
# tempf<-tempf %>% select(pref, sex)
# tempm<-as.data.frame(vector(length =(length(seg1_mpreference_familiar_corner_and_interaction))))
# tempm$pref<-seg1_mpreference_familiar_corner_and_interaction
# tempm$sex<-"male"
# tempm<-tempm %>% select(pref, sex)
# temp<-rbind(tempf,tempm)
# 
# ggplot(temp, aes(x= sex, y = pref))+
#   geom_dotplot(binaxis='y', stackdir='center')+
#   geom_hline(yintercept = 0.5, linetype = "dashed")

```  
  
#Fig 2A - NOR familiar preference across segments, interaction effect of sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}
fullframemint<-fullframem %>% select(preference_familiar_corner_and_interaction, segment)
fullframemint$sex<-"male"
fullframefint<-fullframef %>% select(preference_familiar_corner_and_interaction, segment)
fullframefint$sex<-"female"
fullframeint<-rbind(fullframemint,fullframefint)
mod<-lm(fullframeint$preference_familiar_corner_and_interaction ~ fullframeint$segment * fullframeint$sex)
 tidy(mod)
#p value of interaction
p_valueint<-tidy(mod)[[5]][4]
print("pvalue interaction of sex")
print(p_valueint)
fullframeint$preference_familiar_corner_and_interaction<-as.numeric(as.character(fullframeint$preference_familiar_corner_and_interaction))
fullframeint$segment<-as.numeric(as.character(fullframeint$segment))
fullframeint$sex<-as.factor(as.character(fullframeint$sex))

p <- ggplot(fullframeint, aes(x = as.numeric(segment), y = as.numeric(preference_familiar_corner_and_interaction), color = sex)) + 
  geom_point(size = 4) +
  geom_smooth(method = "lm", size = 1.3, se = FALSE) +
  theme(text = element_text(size=10)) +
  annotate("text", x=0.5, y=47, label= glue::glue("p interaction of sex = {round(p_valueint,7)}
                                                    number of individuals = {nrow(fullframeint)}"), size = 4, color = "black", hjust = 0) +
  labs(x= "segment (60 seconds each)",y="nov familiar preference") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+
         theme(panel.background = element_blank()) +
  scale_color_manual(values=c("orchid4", "cadetblue3")) +
  theme(plot.title = element_text(hjust = 0))+ 
  scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))+
  geom_hline(yintercept = 50, linetype="dashed", color = "gray70")
plot(p)

print("male preference seg 1 differs from 50%")
wilcox.test(seg1_mpreference_familiar_corner_and_interaction, mu = 0.5)

print("female preference seg 10 differs from 50%")
wilcox.test(seg10_fpreference_familiar_corner_and_interaction, mu = 0.5)


```


############
#Fig 4A - SPA learners (234) vs nonlearners by sex stacked bar graph
```{r, echo = FALSE, message=FALSE, warning=FALSE}

###########learning category by sex

spacurve <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/SPA_first_choice_four_trials.csv")
spacurve<-spacurve %>% filter(sex == "male" | sex == "female")
spacurve$SPA_learn_cat_numeric<-as.numeric(spacurve$SPA_learning_category)

#is trial 1 random overall?
a<-spacurve %>% filter(trial1_firstchoice == "correct") %>%nrow
x<-spacurve %>% filter(trial1_firstchoice == "incorrect") %>%nrow
b<-(a + x) / 2
z<-(a + x) / 2
real = c(a,x)
expected = c(b,z)
spasolvesex<-data.frame(real, expected)
chi<-chisq.test(spasolvesex, correct=FALSE)
chip<-chi$p.value #first different from random? NO
print("p value of spa trial 1, aka are fish picking randomly")
print(chip)

 spacurve <-spacurve %>% filter(is.na(SPA_learning_category) == FALSE)
 spacurve$SPA_learn_cat_numeric<-as.numeric(as.factor(spacurve$SPA_learning_category))

 
#2 high
#3 low
#4 non
 
 a<-nrow(spacurve %>%filter(sex == "female") %>%filter(SPA_learn_cat_numeric == 4 | SPA_learn_cat_numeric == 3))
 x<-nrow(spacurve %>%filter(sex == "female") %>%filter(SPA_learn_cat_numeric == 2))
 
 b<-nrow(spacurve %>%filter(sex == "male") %>%filter(SPA_learn_cat_numeric == 4 | SPA_learn_cat_numeric == 3))
 y<-nrow(spacurve %>%filter(sex == "male") %>%filter(SPA_learn_cat_numeric == 2))
 females = c(a,x)
 males = c(b,y)
 spasolvesex<-data.frame(females,males)
 chi<-chisq.test(spasolvesex)
 chip<-chi$p.value # high vs everyone else
 print("comparing males and females high vs everyone else")
 print(chip)
 
 #female binomial probability
 #n = 51 aka total number of fish
 #probability of success for a given fish p = 0.125 aka 12.5% chance to get all three trials correct
 #n = 12 successes aka fish who learned
 p.binom<-binom.test(12, 51,p=0.125)
 print("binomial probability of 12 female learners(234)")
 print(p.binom)
 p.binom<-p.binom$p.value
 
 spacurve$sex<-as.factor(spacurve$sex)
 spacurve$high_or_not<-vector(length = nrow(spacurve))
 i<-1
 for (i in 1:nrow(spacurve)){
 if(spacurve$SPA_learn_cat_numeric[i] == 2){
   spacurve$high_or_not[i]<-"234learn"
 }
   else{spacurve$high_or_not[i]<-"not"}}
spacurve<-spacurve %>% select (c("sex", "high_or_not"))   
spacurve$high_or_not<-(as.factor(spacurve$high_or_not))
spacurve$sex<-as.factor(spacurve$sex)

ggplot(spacurve, aes(high_or_not, fill = sex))+
 geom_bar(width = 0.7) + 
labs(x= "leaner (234)         nonlearner",y=glue::glue("females= {females[1]},{females[2]}
                                                                         males= {males[1]},{males[2]}
                                                                         female binomial prob = {round(p.binom, 4)}")) + 
  theme_classic()+
   theme(plot.title = element_text(hjust = 0)) +
  scale_fill_manual(values=c("orchid4", "cadetblue3")) +
   theme(legend.position="left") +
  theme(aspect.ratio = 1.6/1)


```

#Fig 4B - SPA reward preference by sex stacked bar graph
```{r, echo = FALSE, message=FALSE, warning=FALSE}
#SPATIAL MAZE

 shapiro_test<-shapiro.test(df$SPAprop_correct_including_corners_of_corner_and_platform_time) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$SPAprop_correct_including_corners_of_corner_and_platform_time~df$sex)
 p_value_wilcox<-wilcox_test$p.value
 print(paste("does spa % rewarded of decision time differ by sex? wilcox p value = ", round(p_value_wilcox,4)))
 cohen<-cohen.d(df$SPAprop_correct_including_corners_of_corner_and_platform_time~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
print(cohen)
 

zones<-rep(c("rewarded" , "unrewarded"), 2)
sex<-c(rep(c("female"),2), rep(c("male"),2))
fpct<-c(mean(df.female$SPAprop_correct_including_corners_of_corner_and_platform_time, na.rm = TRUE), 1-mean(df.female$SPAprop_correct_including_corners_of_corner_and_platform_time, na.rm = TRUE))
fpct<-fpct * 100
mpct<-c(mean(df.male$SPAprop_correct_including_corners_of_corner_and_platform_time, na.rm = TRUE), 1-mean(df.male$SPAprop_correct_including_corners_of_corner_and_platform_time, na.rm = TRUE))
mpct<-mpct * 100
fpct<-round(fpct)
mpct<-round(mpct)
pct<-append(fpct,mpct)

 data <- data.frame(zones,sex, pct)
ggplot(data, aes(fill=zones, y=pct, x=sex)) + 
    geom_bar(position="stack", stat="identity", width = 0.7) + 
  theme(aspect.ratio = 1.6/1) +
  ggtitle("spa reward preference p = 0.00316 cohen's d = 0.447")+
  scale_fill_manual(values=c("tomato2", "dodgerblue4")) +
  theme_classic()+
  theme(aspect.ratio = 1.6/1)

```

#Fig 4C - SPA decision latency boxplot by sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}
#latency to decide
 shapiro_test<-shapiro.test(df$SPAlatency_to_enter_a_corner) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)

wilcox_test<-wilcox.test(df$SPAlatency_to_enter_a_corner~df$SPAsex)
p_value_wilcox<-wilcox_test$p.value
 cohen<-cohen.d(df$SPAlatency_to_enter_a_corner~df$SPAsex)
 cohen<-abs(cohen$estimate)
 print(paste("does SPAlatency_to_enter_a_corner differ by sex? wilcox p value = ", round(p_value_wilcox,4)))
 print ("cohen")
 print(cohen)
number<-df %>% filter (is.na(SPAlatency_to_enter_a_corner) == FALSE) %>% filter(is.na(sex) == FALSE) %>% nrow()
  print("number")
print(number)

p<- ggplot(df, aes(x=df$SPAsex, y=df$SPAlatency_to_enter_a_corner)) + 
   geom_boxplot(lwd=1, fill = c("gray75", "gray95"))+
   labs(title = "SPAlatency_to_enter_a_corner by SPAsex") +
   stat_n_text(size = 5) +
   geom_text(x=3, y=1, label= glue::glue("p(wilcox)= {round(p_value_wilcox,4)}
                                         cohen's d = {round(cohen,4)}"), size = 5, color = "gray27", fontface = 'italic')+
  theme_classic()
 plot(p)
```

#Fig 4D - SPA decision latency by reward latency, interaction effect of sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}
 mod<-lm(df$SPAlatency_to_enter_a_corner ~ df$SPAlatency_to_enter_correct_corner * df$sex)
 tidy(mod)
#p value of interaction
p_valueint<-tidy(mod)[[5]][4]
print("pvalue interaction of sex")
print(p_valueint)
number<-df%>% filter(is.na(SPAlatency_to_enter_a_corner) == FALSE)%>% filter(is.na(SPAlatency_to_enter_correct_corner) == FALSE)%>% filter(is.na(sex) == FALSE) %>%nrow()



p <- ggplot(df, aes(SPAlatency_to_enter_correct_corner, SPAlatency_to_enter_a_corner, color = sex)) + geom_point(size = 4) +
  geom_smooth(method = "lm", size = 1.3, se = FALSE,full.continuousrange=TRUE) +
  theme(text = element_text(size=10)) +
  annotate("text", x=0.05, y=400, label= glue::glue("p interaction = {round(p_valueint,7)}
                                                    n = {number}"), size = 6, color = "maroon", hjust = 0) +
  labs(x= "SPAlatency_to_enter_a_corner",y="SPAlatency_to_enter_correct_corner") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+
         theme(panel.background = element_blank()) +
  scale_color_manual(values=c("orchid4", "cadetblue3")) +
  theme(plot.title = element_text(hjust = 0))
p

```

#Fig 4E - SA error correction speed boxplot by sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}
#error correction speed in SPA
temp<-spa %>% select(SPAsex, SPAlatency_to_enter_a_corner, SPAlatency_to_enter_correct_corner)
temp<- mutate(temp, correction_speed = SPAlatency_to_enter_correct_corner - SPAlatency_to_enter_a_corner)
temp<-temp%>% filter(correction_speed >0)

#female average correction speed
print("female afterage correction speed")
temp %>% filter(SPAsex == "female") %>% mean(correction_speed, na.rm = TRUE)

#male average correction speed
temp.f<-temp %>% filter(SPAsex == "female")
mean(temp.f$correction_speed)

#boxplot of correction speed by sex
temp.m<-temp %>% filter(SPAsex == "male")
mean(temp.m$correction_speed)

 shapiro_test<-shapiro.test(temp$correction_speed) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)

wilcox_test<-wilcox.test(temp$correction_speed~temp$SPAsex)
p_value_wilcox<-wilcox_test$p.value
 cohen<-cohen.d(temp$correction_speed~temp$SPAsex)
 cohen<-abs(cohen$estimate)
 print(paste("does correction_speed differ by sex? wilcox p value = ", round(p_value_wilcox,4)))
print(cohen)

p<- ggplot(temp, aes(x=temp$SPAsex, y=temp$correction_speed)) + 
   geom_boxplot(lwd=1, fill = c("gray75", "gray95"))+ 
   labs(title = "correction_speed by SPAsex") +
   stat_n_text(size = 5) +
   geom_text(x=1, y=640, label= glue::glue("p(wilcox)= {round(p_value_wilcox,4)}
                                         cohen's d = {round(cohen,4)}"), size = 4, color = "gray27", fontface = 'italic')+
  theme_classic()
 plot(p)
```

############
#Fig 6A - SPA reward preference by NOR familiar preference filtering out 0's and 1's, linear regression
```{r, echo = FALSE, message=FALSE, warning=FALSE}
#NOV preference by SPA preference, filtering by both side this time
tnov <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/NOV_master.csv")
tnov<-tnov%>%filter(NOVtrial == "NOV1")
tnov<-tnov%>%filter(NOVvid_length >= 480)
#tnov<-tnov%>%filter(NOVdid_fish_enter_both_interaction_zones == 1) 
tnov<-tnov%>%filter(NOVprop_sum_left > 0 & NOVprop_sum_right > 0)

tspa <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/SPA_master.csv")
tspa<-tspa%>%filter(SPAtrial == "SPA4")
tspa<-tspa%>%filter(SPAvid_length >= 480)
tspa<-tspa%>% filter(SPAprop_right_corner > 0 & SPAprop_left_corner > 0)
temp<-left_join(tnov,tspa, by= "fishID")

mod<- lm(temp$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time ~ temp$SPAprop_correct_including_corners_of_corner_and_platform_time)
number <- temp %>% filter(!is.na(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)) %>% filter(!is.na(SPAprop_correct_including_corners_of_corner_and_platform_time)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared
 print(p_value)

temp$NOVsex<-as.factor(temp$NOVsex) 
temp$SPAprop_correct_including_corners_of_corner_and_platform_time <-as.numeric(temp$SPAprop_correct_including_corners_of_corner_and_platform_time)
temp$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time<-as.numeric(temp$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
p <- ggplot(temp, aes(as.numeric(SPAprop_correct_including_corners_of_corner_and_platform_time), as.numeric(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time), color = NOVsex)) + geom_point(size = 4) +
  theme(text = element_text(size=10)) +
  geom_smooth(method = "lm", size = 1.3, color = "lightgray", se = FALSE) +
annotate("text", x=0.05, y=0.25, label= glue::glue("p = {round(p_value,4)}
r2 = {round(r_squared,4)}
n = {number}"), size = 4, hjust = 0) +
  labs(x= "SPAprop_correct_including_corners_of_corner_and_platform_time",y="NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+
         theme(panel.background = element_blank()) +
  scale_color_manual(values=c("orchid4", "cadetblue3")) +
  theme(plot.title = element_text(hjust = 0))
plot(p)


```

#Fig 6B - NOR interaction latency by SPA first choice boxplot
```{r, echo = FALSE, message=FALSE, warning=FALSE}
 #NOV latency x SPA first choice
 print("NOVlatency_to_enter_a_interaction by SPAfirst_choice_correct_or_incorrect_corner")
shapiro_test<-shapiro.test(df$NOVlatency_to_enter_a_interaction) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$NOVlatency_to_enter_a_interaction~df$SPAfirst_choice_correct_or_incorrect_corner)
print(wilcox_test)
p_value_wilcox<-wilcox_test$p.value
 cohen<-cohen.d(df$NOVlatency_to_enter_a_interaction~df$SPAfirst_choice_correct_or_incorrect_corner)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(NOVlatency_to_enter_a_interaction) == FALSE) %>% filter(is.na(SPAfirst_choice_correct_or_incorrect_corner) == FALSE) %>% nrow()
 
 #one outlier removed from figure
 p<- ggplot(df, aes(x = df$SPAfirst_choice_correct_or_incorrect_corner, y = df$NOVlatency_to_enter_a_interaction)) +
   geom_boxplot(lwd=1)+ theme(axis.text.y = element_text(size = 14)) + theme(axis.text.x = element_text(size = 14)) +
   stat_n_text(size = 5)+
   ylim(0.,100)+
   theme_classic()+
   geom_text(x=1, y=100, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 3, color = "gray27", fontface = 'italic')
 plot(p)
```

#Fig 6C - SPA decision latency by NOR first choice boxplot
```{r, echo = FALSE, message=FALSE, warning=FALSE}
 #SPA latency x NOV first choice
  print("SPAlatency_to_enter_a_corner by NOVfirst_choice_familiar_or_novel")
shapiro_test<-shapiro.test(df$SPAlatency_to_enter_a_corner) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$SPAlatency_to_enter_a_corner~df$NOVfirst_choice_familiar_or_novel)
print(wilcox_test)
p_value_wilcox<-wilcox_test$p.value
 cohen<-cohen.d(df$SPAlatency_to_enter_a_corner~df$NOVfirst_choice_familiar_or_novel)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(SPAlatency_to_enter_a_corner) == FALSE) %>% filter(is.na(NOVfirst_choice_familiar_or_novel) == FALSE) %>% nrow()
 
  p<- ggplot(df, aes(x = df$NOVfirst_choice_familiar_or_novel, y = df$SPAlatency_to_enter_a_corner)) +
   geom_boxplot(lwd=1)+ theme(axis.text.y = element_text(size = 14)) + theme(axis.text.x = element_text(size = 14)) +
   stat_n_text(size = 5)+
   theme_classic()+
   geom_text(x=1, y=400, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 3, color = "gray27", fontface = 'italic')
 plot(p)
 
```

#Table 1 - model averaged importance of terms analysis for combined dataset
#waiting on glmulti fix
```{r, echo = FALSE, message=FALSE, warning=FALSE}
# temp<- df %>% select(fullcontinuouslist, "sex")
# temp$sex<-as.factor(temp$sex)
# temp<-na.omit(temp)
# print(nrow(temp))
# 
# #BOTH
#  factors<-fullcontinuouslist
# res <- glmulti("sex", factors, temp,
#                level=1, crit="aicc", method = "d", family = binomial,confsetsize=100, minsize = 1)
# print(paste("Number of SPA models compared:", res[1]))
# 
# res <- glmulti("sex", factors, temp,
#               level=1, crit="aicc", method = "g", family = binomial,confsetsize=100, minsize = 1) 
# 
# top <- weightable(res)
# top <- top[top$aicc <= min(top$aicc) + 2,]
# #print(top)
# #BEST MODEL (all permutations)
# print("BEST BOTH MODEL")
# summ(res@objects[[1]])
# nullmod <- glm(sex~1, family="binomial", data = temp)
#  mcfadden<-1-(as.numeric(logLik(res@objects[[1]]))/as.numeric(logLik(nullmod))) #mcfadden's pseudo r squared statistic for logistic regression
#  print("McFadden of bestAICc BOTH")
#  print(mcfadden)
# #relative importance of coefficients averaged across all models
# plot(res, type="s")
# mmi <- as.data.frame(coef(res))
# mmi <- mmi%>% select(Importance)
# print(mmi)

```


############SUPPLEMENTALS
#Supp 3 - NOR "space transition matrix" over time, 1 minute segments
```{r, echo = FALSE, message=FALSE, warning=FALSE}

segs <- c(rep("seg1" , 6) , rep("seg2" , 6) , rep("seg3" , 6) , rep("seg4" , 6) , rep("seg5" , 6), rep("seg6" , 6), rep("seg7" , 6), rep("seg8" , 6), rep("seg9" , 6), rep("tseg10" , 6))
zones <- rep(c("familiar alley" , "novel alley" , "familiar corners","novel corners","familiar interaction","novel interaction") , 10)
percent <- fullframevaluef
data <- data.frame(segs,zones,percent)
ggplot(data, aes(fill=zones, y=percent, x=segs)) + 
    geom_bar(position="stack", stat="identity") + 
  ggtitle("novel object 60 second split, FEMALE ONLY")+
  scale_fill_manual(values=c("gray82", "lightskyblue2", "lightpink1", "gray50", "royalblue4" , "coral4")) + theme_classic()


segs <- c(rep("seg1" , 6) , rep("seg2" , 6) , rep("seg3" , 6) , rep("seg4" , 6) , rep("seg5" , 6), rep("seg6" , 6), rep("seg7" , 6), rep("seg8" , 6), rep("seg9" , 6), rep("tseg10" , 6))
zones <- rep(c("familiar alley" , "novel alley" , "familiar corners","novel corners","familiar interaction","novel interaction") , 10)
percent <- fullframevaluem
data <- data.frame(segs,zones,percent)
ggplot(data, aes(fill=zones, y=percent, x=segs)) + 
    geom_bar(position="stack", stat="identity") + 
  ggtitle("novel object 60 second split, MALE ONLY")+
  scale_fill_manual(values=c("gray82", "lightskyblue2", "lightpink1", "gray50", "royalblue4" , "coral4")) + theme_classic()

```

#Supp 4 - SPA trial 4 first choice rewarded or unrewarded, stacked bar graph by sex
```{r, echo = FALSE, message=FALSE, warning=FALSE}

spa <-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/SPA_master.csv")
weight<-read.csv("/stor/work/Hofmann/projects/aburtoni_cognition_social_competence/Analysis scripts and excel sheets/sex differences/sex_differences_data_sheets/weight_SL.csv")
tempdf<-left_join(weight,spa, by = "fishID")

tempspa<-tempdf%>%filter(SPAtrial == "SPA4")
tempspa$SPAfirst_choice_correct_or_incorrect_corner_numeric<-as.numeric(tempspa$SPAfirst_choice_correct_or_incorrect_corner) #correct = 1
tempspa.male<-tempspa %>% filter(sex == "male")
tempspa.female<-tempspa %>% filter(sex == "female")

firstchoice<-"SPAfirst_choice_correct_or_incorrect_corner_numeric"

w<-tempspa.male %>% filter(SPAfirst_choice_correct_or_incorrect_corner_numeric == 1) %>% nrow()
x<-tempspa.female %>% filter(SPAfirst_choice_correct_or_incorrect_corner_numeric == 1) %>% nrow()
y<-tempspa.male %>% filter(SPAfirst_choice_correct_or_incorrect_corner_numeric == 2) %>% nrow()
z<-tempspa.female %>% filter(SPAfirst_choice_correct_or_incorrect_corner_numeric == 2) %>% nrow()
choice1 = c(w,x)
choice2 = c(y,z)
solve<-data.frame(choice1,choice2)
chi<-chisq.test(solve, correct=FALSE)
chip<-chi$p.value
print("sex by first choice")
print(solve)
print(chi)
print(chip)
temp<-tempspa %>% select(SPAfirst_choice_correct_or_incorrect_corner_numeric, SPAsex)
temp[,1]<-as.factor(temp[,1])
colnames(temp)<-c("choice", "factor")
temp<-temp%>%filter(is.na(choice)== FALSE)
p<-ggplot(temp, aes(choice, fill = factor))+
  geom_bar() + 
  labs(x= "SPA4 first choice (rewarded on left), colored by sex",y=glue::glue("rewarded= males {choice1[1]},females {choice1[2]}
                                                                        unrewarded= males {choice2[1]},females {choice2[2]}
                                                                        chi-squared p- value = {round(chip, 4)}")) +  
  scale_x_discrete(breaks=c(1, 2)) +
  theme(plot.title = element_text(hjust = 0)) +
  scale_color_manual(values=c("orchid4", "cadetblue3")) +
  theme(legend.position="left") + 
  scale_fill_manual(values=c("orchid4", "cadetblue3"),name="Sex",labels=c("  Female", "  Male"))+
  theme_classic()+
  theme(aspect.ratio = 1.6/1)
plot(p)


```

#Supp 5 - SPA "space transition matrix" over time, 1 minute segments
```{r, echo = FALSE, message=FALSE, warning=FALSE}

segs <- c(rep("seg1" , 6) , rep("seg2" , 6) , rep("seg3" , 6) , rep("seg4" , 6) , rep("seg5" , 6), rep("seg6" , 6), rep("seg7" , 6), rep("seg8" , 6), rep("seg9" , 6), rep("tseg10" , 6))
zones <- rep(c("sum wall" , "neutral zone" , "rewarded corner","unrewarded corner","rewarded platform","unrewarded platform") , 10)
percent <- fullframevaluef
data <- data.frame(segs,zones,percent)
ggplot(data, aes(fill=zones, y=percent, x=segs)) + 
    geom_bar(position="stack", stat="identity") + 
  ggtitle("spatial maze 60 second split, FEMALE ONLY")+
  scale_fill_manual(values=c("violetred1", "violetred4", "aquamarine1", "aquamarine3", "gray55" , "gray17"))+ theme_classic() 

segs <- c(rep("seg1" , 6) , rep("seg2" , 6) , rep("seg3" , 6) , rep("seg4" , 6) , rep("seg5" , 6), rep("seg6" , 6), rep("seg7" , 6), rep("seg8" , 6), rep("seg9" , 6), rep("tseg10" , 6))
zones <- rep(c("sum wall" , "neutral zone" , "rewarded corner","unrewarded corner","rewarded platform","unrewarded platform") , 10)
percent <- fullframevaluem
data <- data.frame(segs,zones,percent)
ggplot(data, aes(fill=zones, y=percent, x=segs)) + 
    geom_bar(position="stack", stat="identity") + 
  ggtitle("spatial maze 60 second split, MALE ONLY")+
  scale_fill_manual(values=c("violetred1", "violetred4", "aquamarine1", "aquamarine3", "gray55" , "gray17")) + theme_classic()

 shapiro_test<-shapiro.test(df$SPAprop_sum_wall) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$SPAprop_sum_wall~df$sex)
 p_value_wilcox<-wilcox_test$p.value
 print(paste("does SPAprop_sum_wall differ by sex? wilcox p value = ", round(p_value_wilcox,4)))


```

#Supp 7 - NOR and SPA best model table and model averaged importance of terms for each task individually (best predicting sex)
#waiting on glmulti fix
```{r, echo = FALSE, message=FALSE, warning=FALSE}
# temp<- df %>% select(fullcontinuouslist, "sex")
# temp$sex<-as.factor(temp$sex)
# temp<-na.omit(temp)
# print(nrow(temp))
# 
# #NOV
# factors<-newnovlist
# res <- glmulti("sex", factors, temp,
#                level=1, crit="aicc", method = "d", family = binomial,confsetsize=100, minsize = 1)
# print(paste("Number of NOV models compared:", res[1]))
# res <- glmulti("sex", factors, temp,
#                level=1, crit="aicc", method = "h", family = binomial,confsetsize=100, minsize = 1) #minsize = 1 so that I don't get the best model being just the intercept term
# top <- weightable(res)
# top <- top[top$aicc <= min(top$aicc) + 2,]
# #print(top)
# #BEST MODEL (all permutations)
# print("BEST NOV MODEL")
# summ(res@objects[[1]])
# nullmod <- glm(sex~1, family="binomial", data = temp)
#  mcfadden<-1-(as.numeric(logLik(res@objects[[1]]))/as.numeric(logLik(nullmod))) #mcfadden's pseudo r squared statistic for logistic regression
#  print("McFadden of bestAICc NOV")
#  print(mcfadden)
# #relative importance of coefficients averaged across all models
# plot(res, type="s")
# mmi <- as.data.frame(coef(res))
# mmi <- mmi%>% select(Importance)
# print(mmi)
# 
# #SPA
# factors<-spalist
# res <- glmulti("sex", factors, temp,
#                level=1, crit="aicc", method = "d", family = binomial,confsetsize=100, minsize = 1)
# print(paste("Number of SPA models compared:", res[1]))
# res <- glmulti("sex", factors, temp,
#                level=1, crit="aicc", method = "h", family = binomial,confsetsize=100, minsize = 1) #minsize = 1 so that I don't get the best model being just the intercept term
# top <- weightable(res)
# top <- top[top$aicc <= min(top$aicc) + 2,]
# #print(top)
# #BEST MODEL (all permutations)
# print("BEST SPA MODEL")
# summ(res@objects[[1]])
# nullmod <- glm(sex~1, family="binomial", data = temp)
#  mcfadden<-1-(as.numeric(logLik(res@objects[[1]]))/as.numeric(logLik(nullmod))) #mcfadden's pseudo r squared statistic for logistic regression
#  print("McFadden of bestAICc SPA")
#  print(mcfadden)
# #relative importance of coefficients averaged across all models
# plot(res, type="s")
# mmi <- as.data.frame(coef(res))
# mmi <- mmi%>% select(Importance)
# print(mmi)


```

#############
#Other statistics included in the manuscript
```{r, echo = FALSE, message=FALSE, warning=FALSE}

#NOV familiar preference
print("NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time by sex")
shapiro_test<-shapiro.test(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time~df$sex)
print(wilcox_test)
 cohen<-cohen.d(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time) == FALSE) %>% filter(is.na(sex) == FALSE) %>% nrow()
 

print("NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time by NOVround")
shapiro_test<-shapiro.test(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 kruskal_test<-kruskal.test(df$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time~df$NOVround)
print(kruskal_test)
#df %>% kruskal_test(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time ~ NOVround)
#H = 10.3
eta <- (10.3 - 8 + 1)/(96 - 8) 


 df %>% filter(is.na(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time) == FALSE) %>% filter(is.na(NOVround) == FALSE) %>% nrow()
 
 
 #SPA reward preference
print("SPAprop_correct_including_corners_of_corner_and_platform_time by sex")
shapiro_test<-shapiro.test(df$SPAprop_correct_including_corners_of_corner_and_platform_time) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$SPAprop_correct_including_corners_of_corner_and_platform_time~df$sex)
print(wilcox_test)
 cohen<-cohen.d(df$SPAprop_correct_including_corners_of_corner_and_platform_time~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(SPAprop_correct_including_corners_of_corner_and_platform_time) == FALSE) %>% filter(is.na(sex) == FALSE) %>% nrow()
 

 #NOV object approach latency (interaction) by sex
 
 print("NOVlatency_to_enter_a_interaction by sex")
shapiro_test<-shapiro.test(df$NOVlatency_to_enter_a_interaction) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$NOVlatency_to_enter_a_interaction~df$sex)
print(wilcox_test)
 cohen<-cohen.d(df$NOVlatency_to_enter_a_interaction~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(NOVlatency_to_enter_a_interaction) == FALSE) %>% filter(is.na(sex) == FALSE) %>% nrow()
 
 
  #NOV object interaction by sex
 print("NOVprop_sum_interaction by sex")
shapiro_test<-shapiro.test(df$NOVprop_sum_interaction) #if this is NOT significant, you can use t test results
 p_value_shapiro<-shapiro_test$p.value
 print("shapiro")
 print(p_value_shapiro)
 p_value_wilcox<-NA
 wilcox_test<-wilcox.test(df$NOVprop_sum_interaction~df$sex)
print(wilcox_test)
 cohen<-cohen.d(df$NOVprop_sum_interaction~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
 print(cohen)
 print("number")
 df %>% filter(is.na(NOVprop_sum_interaction) == FALSE) %>% filter(is.na(sex) == FALSE) %>% nrow()
 
 
 #are any of the objects preferred more than random?
 
 #cap significantly preferred above 50%?
 listcapfam<-nov %>% filter(NOVfamiliar_object == "cap") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listcapfam<-as.data.frame(listcapfam)
 listcapnov<-nov %>% filter(NOVnovel_object == "cap") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 i<-1
 for (i in 1:length(listcapnov)){
   listcapnov[i]<-1-listcapnov[i]
 }
 listcapnov<-as.data.frame(listcapnov)
 listcap<-rbind.fill(list(listcapfam,listcapnov))
 listcap<-as.vector(listcap$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listcap<-na.omit(listcap)
 listcap<-as.numeric(listcap)
 shapiro_test<-shapiro.test(listcap)
 wilcox.test(listcap, mu = 0.5)
 wilcox_test
 print("average preference for the cap across all contexts")
 mean(listcap)
 #ball significantly preferred above 50%?
  listballfam<-nov %>% filter(NOVfamiliar_object == "ball") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listballfam<-as.data.frame(listballfam)
 listballnov<-nov %>% filter(NOVnovel_object == "ball") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
  i<-1
 for (i in 1:length(listballnov)){
   listballnov[i]<-1-listballnov[i]
 }
 listballnov<-as.data.frame(listballnov)
 listball<-rbind.fill(list(listballfam,listballnov))
 listball<-as.vector(listball$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listball<-na.omit(listball)
 listball<-as.numeric(listball)
 shapiro_test<-shapiro.test(listball)
 wilcox_test<-wilcox.test(listball, mu = 0.5)
 wilcox_test
 print("average preference for the ball across all contexts")
 mean(listball)
 #weight significantly preferred above 50%?
  listweighfam<-nov %>% filter(NOVfamiliar_object == "weigh") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listweighfam<-as.data.frame(listweighfam)
 listweighnov<-nov %>% filter(NOVnovel_object == "weigh") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
  i<-1
 for (i in 1:length(listweighnov)){
   listweighnov[i]<-1-listweighnov[i]
 }
 listweighnov<-as.data.frame(listweighnov)
 listweigh<-rbind.fill(list(listweighfam,listweighnov))
 listweigh<-as.vector(listweigh$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listweigh<-na.omit(listweigh)
 listweigh<-as.numeric(listweigh)
 shapiro_test<-shapiro.test(listweigh)
 wilcox_test<-wilcox.test(listweigh, mu = 0.5)
 wilcox_test
 print("average preference for the weigh across all contexts")
 mean(listweigh)
 #tube significantly preferred above 50%?
  listtubefam<-nov %>% filter(NOVfamiliar_object == "tube") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listtubefam<-as.data.frame(listtubefam)
 listtubenov<-nov %>% filter(NOVnovel_object == "tube") %>% select(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
  i<-1
 for (i in 1:length(listtubenov)){
   listtubenov[i]<-1-listtubenov[i]
 }
 listtubenov<-as.data.frame(listtubenov)
 listtube<-rbind.fill(list(listtubefam,listtubenov))
 listtube<-as.vector(listtube$NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time)
 listtube<-na.omit(listtube)
 listtube<-as.numeric(listtube)
 shapiro_test<-shapiro.test(listtube)
 wilcox_test<-wilcox.test(listtube, mu = 0.5)
 wilcox_test
 print("average preference for the tube across all contexts")
 mean(listtube)
 
  print("average preference for the cap across all contexts")
 mean(listcap)
   print("average preference for the ball across all contexts")
 mean(listball)
   print("average preference for the weigh across all contexts")
 mean(listweigh)
   print("average preference for the tube across all contexts")
 mean(listtube)
 
 
 cap<-as.data.frame(vector(length = 41))
 weigh<-as.data.frame(vector(length = 41))
 cap$object<-"cap"
 cap$pref<-as.numeric(unlist(listcap))
 weigh$object<-"weigh"
 weigh$pref<-as.numeric(unlist(listweigh))
 temp<-rbind(cap,weigh)
 temp$object<-as.factor(temp$object)
 temp$pref<-as.numeric(as.character(temp$pref))
 print("capweigh")
 wilcox.test(temp$pref~temp$object, paired = TRUE)
 
 
  tube<-as.data.frame(vector(length = 55))
 ball<-as.data.frame(vector(length = 55))
 tube$object<-"tube"
 tube$pref<-as.numeric(unlist(listtube))
 ball$object<-"ball"
 ball$pref<-as.numeric(unlist(listball))
 temp<-rbind(tube,ball)
 temp$object<-as.factor(temp$object)
 temp$pref<-as.numeric(as.character(temp$pref))
 print("balltube")
 wilcox.test(temp$pref~temp$object, paired = TRUE)
 
 
 #males higher thigmotaxis
 wilcox.test(df$SPAprop_sum_wall~df$sex)
  cohen<-cohen.d(df$SPAprop_sum_wall~df$sex)
 cohen<-abs(cohen$estimate)
 print("cohen")
print(cohen)
 
 

#do rounds that have one object pair do better than rounds with the other object pair?
#rouds that had cap weigh = 1 2 5 6
#rounds that had ball tube = 3 4 7 8
tnov<-nov

a<-tnov %>% filter(NOVround == "round1" | NOVround == "round2" | NOVround == "round5" | NOVround == "round6") %>% filter(NOVfirst_choice_familiar_or_novel == "familiar") %>%nrow
x<-tnov %>% filter(NOVround == "round1" | NOVround == "round2" | NOVround == "round5" | NOVround == "round6")%>% filter(NOVfirst_choice_familiar_or_novel == "novel") %>%nrow
b<-tnov %>% filter(NOVround == "round3" | NOVround == "round4" | NOVround == "round7" | NOVround == "round8") %>% filter(NOVfirst_choice_familiar_or_novel == "novel") %>%nrow
z<-tnov %>% filter(NOVround == "round3" | NOVround == "round4" | NOVround == "round7" | NOVround == "round8") %>% filter(NOVfirst_choice_familiar_or_novel == "familiar") %>%nrow
cap = c(a,x)
ball = c(b,z)
novchi<-data.frame(cap, ball)
chi<-chisq.test(novchi, correct=FALSE)
chip<-chi$p.value
print("does first nov choice vary by which pair of objects received")
print(chip)

#average size of SPA stimulus female:
stim<-c(5.0,4.2,4.7,4.2,4.0,4.7,4.5,4.7,4.8,4.6,4.5,4.5,4.2,4.0,4.8)
mean(stim)


 
 
 
```


#based on glmulti ran in another environment, these are the top models via exhaustive selection:
```{r, echo = FALSE, message=FALSE, warning=FALSE}


#NOV
temp<-df %>% filter(is.na(NOVmean_nov_int_bout_duration) == FALSE)
nullmod <- glm(sex~1, family="binomial", data = temp)
bestNOVmod<-glm(formula = sex ~  NOVmean_nov_int_bout_duration, family = binomial(link='logit'), data = temp)
summ(bestNOVmod)
 mcfadden<-1-logLik(bestNOVmod)/logLik(nullmod) #mcfadden's pseudo r squared statistic for logistic regression
 print("McFadden of best NOV mod")
 print(mcfadden)

#SPA
temp<-df %>% filter(is.na(SPAprop_correct_including_corners_of_corner_and_platform_time) == FALSE) 
temp<- temp %>% filter(is.na(SPAprop_sum_corner) == FALSE)
nullmod <- glm(sex~1, family="binomial", data = temp)
bestSPAmod<-glm(formula = sex ~  SPAprop_correct_including_corners_of_corner_and_platform_time + SPAprop_sum_corner , family = binomial(link='logit'), data = temp)
summ(bestSPAmod)
 mcfadden<-1-logLik(bestSPAmod)/logLik(nullmod) #mcfadden's pseudo r squared statistic for logistic regression
 print("McFadden of best SPA mod")
 print(mcfadden)

#COMBINED
temp<-df %>% filter(is.na(SPAprop_correct_including_corners_of_corner_and_platform_time) == FALSE) 
temp<- temp %>% filter(is.na(SPAprop_correct_including_corners_following_first_correct_corner_entry) == FALSE)
temp<- temp %>% filter(is.na(SPAprop_sum_corner) == FALSE)
temp<- temp %>% filter(is.na(SPAlatency_to_enter_a_corner) == FALSE)
temp<- temp %>% filter(is.na(SPAprop_sum_wall) == FALSE)
temp<- temp %>% filter(is.na(SPAlatency_to_enter_correct_corner) == FALSE)
temp<- temp %>% filter(is.na(NOVprop_sum_interaction) == FALSE)
temp<- temp %>% filter(is.na(NOVprop_sum_alley) == FALSE)
temp<- temp %>% filter(is.na(NOVprop_sum_corner) == FALSE)
temp<- temp %>% filter(is.na(NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time) == FALSE)
temp<- temp %>% filter(is.na(NOVlatency_to_enter_a_interaction) == FALSE)
temp<- temp %>% filter(is.na(NOVnov_entries) == FALSE)
temp<- temp %>% filter(is.na(NOVmean_nov_int_bout_duration) == FALSE)

nullmod <- glm(sex~1, family="binomial", data = temp)
bestBOTHmod<-glm(formula = sex ~   SPAprop_correct_including_corners_of_corner_and_platform_time +
 SPAprop_correct_including_corners_following_first_correct_corner_entry +
 SPAprop_sum_corner +
 SPAlatency_to_enter_a_corner +
 SPAprop_sum_wall +
 SPAlatency_to_enter_correct_corner +
 NOVprop_sum_interaction  +
 NOVprop_sum_alley +
 NOVprop_sum_corner +
 NOVprop_familiar_interaction_and_corner_of_interaction_and_corner_time +
 NOVlatency_to_enter_a_interaction +
 NOVnov_entries +
 NOVmean_nov_int_bout_duration , family = binomial(link='logit'), data = temp)
summ(bestBOTHmod)
 mcfadden<-1-logLik(bestBOTHmod)/logLik(nullmod) #mcfadden's pseudo r squared statistic for logistic regression
 print("McFadden of best BOTH mod")
 print(mcfadden)
 
 
 
```
